<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>initial-setup-of-dynamics-365 on My New Hugo Site</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/</link><description>Recent content in initial-setup-of-dynamics-365 on My New Hugo Site</description><generator>Hugo -- gohugo.io</generator><language>ja-JP</language><atom:link href="https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/index.xml" rel="self" type="application/rss+xml"/><item><title>Dynamics 365 ユーザーを追加する</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/adding-user/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/adding-user/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 のテナント・インスタンスの作成が完了したら、Dynamics 365 にユーザーを追加する手順をご紹介します。 Dynamics 365 は Office 365 のユーザー情報を同期しているため、基本的には Office 365 でユーザー情報を更新することになります。
Office 365 でユーザーを追加する まずは Office 365 (2019年1月時点では Microsoft 365 ) 管理センターへログインします。 左パネルより「ユーザー」を開き「アクティブなユーザー」をクリックして、「＋」をクリックします。
任意の名前やメールアドレスを設定します。
「製品ライセンス」において、Dynamics 365 のライセンスにチェックをいれたら、「追加」をクリックします。
これでユーザーが作成されました。このユーザーはある程度の時間待つと Dynamics 365 でも反映されます。 以下公式ドキュメントでは、数分程度との記載があります。
Office 365 管理センター でユーザーを作成し、ライセンスを割り当てると、Dynamics 365 (online) にもユーザーが作成されます。 Office 365 管理センター と Dynamics 365 (online) 間の 同期処理が完了するまでに数分かかる場合 があります。
ユーザー ID とパスワードを入力することによって、ユーザーは Office 365 管理センター にアクセスして、サービスに関する情報を表示できます。 ただし、このユーザーに少なくとも Dynamics 365 (online) の 1 種類のセキュリティ ロールを割り当てるまで、ユーザーは Dynamics 365 (online) にアクセスできません。</description></item><item><title>Dynamics 365 セキュリティ基本設定</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/basic-security-settings/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/basic-security-settings/</guid><description>Author:Takafumi Noguchi
linkedIn 前回 Dynamics 365 でユーザーを追加しましたが、ここではセキュリティの基本的な構造と設定について理解をしていきましょう。
Dynamics 365 は以下のようなセキュリティの構造になっています。
部署・チーム は組織のグループで、その中でユーザーを追加することで組織グループを細かく管理できます。 セキュリティロールとフィールドセキュリティ はアクセス権の制御で使用します。ここでは、それらついてご紹介していきます。※ フィールドセキュリティは別の記事でご紹介します。
部署 すべてのユーザーは部署に必ず所属します。部署は、通常の組織にある部署のように階層化しており、上位の部署が下位の部署よりも権限が強くなるようにセキュリティ設定を構成していきます。この設定は、後述するセキュリティロールとの組み合わせで実現できます。
Dynamics 365 は既定で部署を１つ作成しています。これはインスタンスと同じ名前で作成されており組織 (ルート部署) と呼ばれています。※ ルート部署は名前の変更や削除ができませんのでご注意ください。
部署は１つの上位部署を持ち、複数の下位部署を持つことができます。例えば以下のような部署を構成することができます。
部署を作成する それでは、部署を作成してみます。Dynamics 365 にアクセスして「設定」の「セキュリティ」 をクリックします。
「新規」ボタンをクリックします。
「名前」を入力して、「上位の部署」にルートの部署を入力したら「保存して閉じる」をクリックします。
上記で作成した部署の下に２つ別の部署を追加します。同じように部署を作成します。
「上位の部署」で先ほど作成した部署を追加します。これで部署が階層化されます。
部署の削除 部署を削除する場合は、一度部署を無効にする必要があります。削除する部署を選択します。
「操作」を開き「無効にする」をクリックします。 ダイアログが表示されるので「非アクティブ化」をクリックします。
無効にしたら、「操作」を開いて「部署の削除」をクリックして部署を削除します。
これで削除は完了です。一度無効にして非アクティブにすることで削除できるようになります。
また、最下層の部署を削除する場合は上述の手順通り削除して問題ありませんが、上位の部署を削除する場合は、まず上位と下位の順序を変更してから削除しましょう。理由として、もし上位をそのまま無効化してしまうと、下位の部署もすべて無効化されてしまうからです。
例）ルート部署 – 部署A – 部署B – 部署C とあり、部署B を削除する場合
まず部署Cの上位の部署を部署Aに切り替える 部署Bを無効化する 部署Bを削除する チーム レコードなどを共有する上で、ユーザーとともに利用され、部署をまたいだコラボレーションを行う場合は、チームを活用することができます。
例えば、営業1課に所属している A さんが、その営業経験を生かして、社内で発足したマーケティングの新プロジェクト参画のオファーがあるとします。この場合、Aさんはマーケティング部の所有するリードやマーケティング戦略情報にアクセスできる新しくマーケティングプロジェクトチームを作成して、そのチームにAさんを所属させることで、Aさんは営業１課に所属しながらも、マーケティング部門とプロジェクトを進めることができるようになるわけです。
また、退職などを理由にレコードの所有者が一時的に不明になった場合は、その退職者が所属していた部署のチームに、レコードの所有者を割り当てることで、同じ部署のメンバーが誰でもアクセスできるようになります。そうすれば、担当者が決まった段階で所有者を自身で変更できるため便利です。
チームの種類 Dynamics 365 のチームは2種類存在します。
所有者チーム: レコードの所有者としてチームを選択することができ、チームにセキュリティ ロールを割り当てることができます。レコードを所有しているチームのユーザーは、そのレコードに対してフル アクセス権が付与されます。(※1) アクセス チーム: レコードの所有者に設定することはできず、セキュリティ ロールの割り当てもできません。アクセス チームはレコードへの 「共有」 によりアクセス権を付与できる仕組みになります。(※2) (※1) 所有者チームは、下図のようにレコードの割り当てで、ユーザーと同様に選択できます。チームをレコードの所有者にすることで、同じ部署に所属するユーザー全体にレコードのアクセス権を付与できるようになるため、担当者が部署移動・退職した際に便利です。また、アクセスチームのように共有設定でアクセス権を付与することも可能です。</description></item><item><title>Dynamics 365 にデータをインポートする</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/how-to-import-data/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/how-to-import-data/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 のセットアップができたら、いよいよデータのインポートになります。インポートする方法はいくつかありますが、本記事では、インポートデータをどのように準備して、インポート処理を行うかについて触れていきます。
データインポートの事前準備 まず、Dynamics 365 でデータをインポートする方法は2パターンあります。
１つは、インポート用のExcelテンプレートを使ってインポートする方法。 もう１つは、Excel Online でデータをインポートする方法です。
初回データインポートであれば、前者の インポート用の Excel テンプレート についてまずは触れていきましょう。
Dynamics 365 では、インポート用のテンプレートが各エンティティごとに用意されており、エンティティに作成されているすべてのフィールドが列となっている Excel ファイルをダウンロードして、そこにデータを書き込み、インポートする手順になります。
テンプレートは以下のように、各エンティティのリスト一覧からダウンロードできます。
インポートしたExcelを開くと、D列からエンティティのフィールドがすべて表示されています。なお、AからC列はシステムで必要な列になるため、変更しないように注意してください。
各列は、フィールドに設定したデータ型も反映されています。そのため、フィールドの型に合わせてデータを入力する必要があります。
データをインポートする際の注意点 データのテンプレートをダウンロードしたら、値を入力してインポートすると思いますが、インポートする上で重要なことは順番です。
エンティティ同士の上位下位関係を考慮しながらインポートしていく必要があります。
例えば、取引先企業 -取引先担当者 – 営業案件 というような上位下位の関係があり、下位のエンティティはもちろん、上位のエンティティを参照しています。もしこの状況で、営業案件からデータをインポートしたらどうなるでしょうか？参照している企業名や担当者名は事前に作成されていないため、インポートエラーになってしまいます。
常にエンティティの上位下位を意識して、上位からのインポートが必須です。
データのインポートを行う それでは、ダウンロードした Excel テンプレートに値を追加していきましょう。今回は、取引先企業のテンプレートに、以下の情報を追加していきます。
取引先企業名： 株式会社インポート
代表電話：03-1234-5050
電子メール：support@import.xyz
株式銘柄コード：7022
業種：農業
企業形態：公開企業
説明：インポート用の会社です。
上述した情報をテンプレートに追加すると以下のようになります。
テンプレートを保存して、さっそくインポートを行います。取引先企業のリスト一覧から、「データのインポート」の▼をクリックして、「データのインポート」をクリックします。
インポートダイアログが表示されたら、先ほどのテンプレートファイルをドラッグ＆ドロップします。そして、「次へ」をクリックします。
インポートファイルの列を追加・削除していないので、すぐに設定の確認画面に遷移します。後ほど説明しますが、もしテンプレートに新しい列を追加したり、列名を編集すると、フィールドのマッピング画面が表示されます。
ここでは、「重複の許可」は いいえ として、「インポート済みのレコードの所有者」をシステム管理者 として 「送信」をクリックします。
すると、インポート処理がスタートします。以下のダイアログの「インポート」をクリックすると、インポートエディタが開きます。
以下のようにステータスが完了して、成功していればインポートされたことになります。
取引先企業にも作成されていることが確認できました。
インポートする列のマッピングを行う それでは、ダウンロードしたテンプレートファイルを少し加工しましょう。FAX列の横に、「ファクシミリ」という列を追加して値を入れます。
このファイルをアップロードします。すると、先ほどファイルをドラッグ＆ドロップした後では表示されなかったダイアログが表示されます。ここでは「次へ」をクリックしましょう。
そして次のダイアログで、マッピングを行います。先ほど追加した「ファクシミリ」が現在どのフィールドともマッピングしていません。
そこで、住所１：FAX とマッピングさせましょう。これで「次へ」をクリックします。
あとは上述の通りにインポートを行います。これでインポートできました。
この方法は、自社に合わせて加工したインポート用のテンプレートを、フィールドが新しく追加された後も利用したい場合の臨時対応で有効です。ただ、データ型などの情報は引き継がれていないため、インポートファイルは常に最新のファイルをダウンロードすることをお勧めします。
さて、ここまでデータのインポートについてお伝えしてきましたが、もしインポート処理が失敗した場合、どのように対処すればいいのでしょうか？</description></item><item><title>Dynamics 365 フィールドセキュリティを設定</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/set-security-field-profile/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/set-security-field-profile/</guid><description> Author:Takafumi Noguchi
linkedIn セキュリティについて、今までロールや部署、チームなどについて触れてきました。ここまでの知識で社内のセキュリティ設定は十分といってもいいのではないでしょうか。
ただ、システムを運用していく過程で、より細かいセキュリティ設定が要求された場合はどうしましょうか。例えば、同じ部署内でも、フィールド単位で、非表示にしたり、書き込みを禁止したりなど細かいセキュリティ設定を必要とする場面があったとします。今でいうと顧客の個人情報としてマイナンバー情報などがわかりやすいのではないでしょうか。
このようなシナリオの場合、Dynamics 365 では、フィールド セキュリティ プロファイルを作成することで実現が可能になります。ではどのように設定していくのでしょうか。
フィールドのセキュリティ設定を有効にする まずは、フィールドセキュリティを設定したいフィールドのプロパティを開きます。
「設定」から「カスタマイズ」を開きましょう。
「システムのカスタマイズ」をクリックして、「エンティティ」を展開して、設定したいエンティティの「フィールド」を開きます。そこで、セキュリティ設定を行うフィールドを選択したらダブルクリックでプロパティ設定を開きます。
「フィールド セキュリティ」を “有効にする” にチェックをいれたら、保存して閉じてください。あとは、システムのカスタマイズの画面で、「すべてのカスタマイズの公開」をクリックして公開をします。
これで、フィールドのセキュリティを有効にする準備は完了です。この時点では、システム管理者以外のユーザーに、上記でセキュリティを有効にしたフィールドは 非表示 となっています。
フィールドセキュリティプロファイルを設定する それでは、フィールドセキュリティの設定を行います。「設定」の「セキュリティ」をクリックしたら、「フィールド セキュリティ プロファイル」をクリックします。
ここでは「新規」ボタンをクリックして新しくプロファイルを作成しましょう。
プロファイル名は “営業用” としてください。一度「保存」をクリックしたら、「フィールドのアクセス許可」をクリックします。
先ほどセキュリティを有効にしたフィールドが表示されているので、選択して「編集」ボタンをクリックします。
以下のような画面になります。ここでは、読み取り権限のみを与える設定にします。「OK」をクリックして設定を完了します。
これで設定は完了です。「保存」をクリックしましょう。
ユーザーにフィールドセキュリティを割り当てる フィールドセキュリティ プロファイルを作成したので、早速ユーザーに割り当てましょう。「ユーザー」をクリックします。
「追加」をクリックしてユーザーを追加します。適用したいユーザーを選択したら「追加」ボタンでユーザーを追加しましょう。
これで、ユーザーへの割り当ては完了です。チームに対しても同じように割り当てることは可能です。
このようにフィールド単位でのセキュリティ設定を行うことは可能ですが、多くのフィールドに対して行い、さらに複数のプロファイルを部署ごとなどで管理すると、設定はとても複雑になってしまいます。
例えば、100のフィールドに対してセキュリティを有効にして、さらにフィールドセキュリティプロファイルを10つ作った場合、単純に 100 x 10 = 1,000 箇所の設定変更が必要になります。
そのため、多くのフィールドを非表示や読み取り専用にしたいという要望があれば、できる限りフォームの業務ルールや javascript で対応するほうが管理上は楽です。
そのあたりを考慮しながら、フィールド セキュリティを利用してみてください。
今回はここまで。</description></item><item><title>Dynamics 365 階層セキュリティ設定について</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/use-security-hierarchy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/use-security-hierarchy/</guid><description> Author:Takafumi Noguchi
linkedIn Dynamics 365 には、エンティティ単位でのセキュリティを制御するセキュリティ ロール、フィールド単位の フィールド セキュリティ、ユーザーの所属を管理する 部署やチーム以外に、階層セキュリティ という発展したセキュリティ概念を持っています。
階層セキュリティの設定は、既定では有効になっていませんが、これからご紹介する手順によって、セキュリティ設定を行うことが可能になります。
階層セキュリティでできること 階層セキュリティを使うと、たとえそのユーザーのエンティティへのアクセス権限が「ユーザーのみ」（自分のレコードのみアクセス可能）となっていたとしても、自身の階層より下の階層のユーザーのデータを閲覧・編集することが可能になるため、セキュリティロールの設定はシンプルに留めつつ、アクセス範囲を広げることができる点が大きなメリットになります。
階層セキュリティは主に２つの階層のどちらかでユーザーのセキュリティ範囲を制御することが可能になります。１つは、「管理者階層」そしてもう１つは 「ポジション階層」 です。
管理者階層は、ユーザーにとっての上司部下の関係によるセキュリティ範囲の設定になり、ポジション階層は、上司部下の関係に関わらず、そのユーザーのポジション（例えば、プロジェクトマネージャー、チームリーダー、プロジェクトメンバー など）により範囲を制御します。
以下の図では、管理者として、社長の下に部長や課長、そして課員がそれぞれ階層化されており、上司は部下のデータに対して閲覧や編集権限を保有するような構造となります。
もしポジション階層ということであれば、以下の図のようにプロジェクトマネージャーというポジション以下にリーダーや開発者などが階層構造となっています。この場合、上司部下という関係性は問われません。（業務委託で外部ベンダーが開発を担う場合などが想像しやすいのではないでしょうか）
階層セキュリティの設定を行う 階層セキュリティの設定を行いましょう。「設定」の「セキュリティ」を開いて、「階層セキュリティ」をクリックします。
管理者階層の設定 「階層モデルの有効化」にチェックをいれると階層セキュリティが有効になります。✔をいれたら、階層モデルを選択します。まずは「管理者階層」で設定をしましょう。
「階層の深さ」については、上述の図を見るとわかりますが、社長からみて１レベル下は、営業部長やシステム部長、２レベル下は営業および課長、３レベル下はエンジニア になります。この階層の深さを考慮するときは、社長のようなすべての権限を保持していてもいい階層で判断するよりも、ある程度のセキュリティ制御が必要な階層を軸に考えるといいです。
部長や課長レベルが、どの階層まで見えていいか、と考えると、深すぎると見える範囲が広がりすぎてしまうので、２や３くらいの深さが妥当ではないでしょうか。今回の例では２とします。
「階層から除外するエンティティを選択してください」では、階層セキュリティに該当させないエンティティを除外できます。これは、ある一部の部署の特定の特権をセキュリティ ロールにてあてられたエンティティがあるのであれば、除外しておくことができます。
今回は特に設定しませんので、そのまま「保存して閉じる」で管理者階層のセキュリティ設定を完了します。
そして、管理者の設定を各ユーザーで行いましょう。「セキュリティ」の「ユーザー」を開いて、特定のユーザー情報を開きます。ユーザー情報にある「組織情報」の「上司」に上司となるべきユーザー名を設定したら保存してください。これで階層が完成しました。
ポジション階層の設定 同じようにポジション階層の設定についても確認しましょう。先ほどの「階層セキュリティ」画面に戻り、「階層モデルの選択」を「カスタム ポジション階層」に設定します。
この時点ではまだポジションを作成していないので、「構成」をクリックします。するとポジションの画面に遷移するので「＋新規」ボタンをクリックして新規作成を行いましょう。
例えば以下のように設定しました。プロジェクトマネージャーというポジションは一番上にあたるので親ポジションは設定せず、ポジションのユーザーを追加しています。このポジションの下に 開発リーダー を作成する場合は、親ポジションを プロジェクトマネージャーに設定します。
すべて作成したら、先ほどの階層セキュリティの設定に戻り、保存して閉じてください。これでポジションによる階層の設定が完了しました。
より細かい解説や検証結果については、以下の技術情報やブログが参考になりますのであわせてご確認ください。
アクセスを制御する階層セキュリティ
[https://docs.microsoft.com/ja-jp/dynamics365/customer-engagement/admin/hierarchy-security])(https://docs.microsoft.com/ja-jp/power-platform/admin/hierarchy-security)
Dynamics CRM 2015/Online 2015 更新プログラム 階層セキュリティ : ポジション階層
https://blogs.msdn.microsoft.com/crmjapan/2015/02/02/dynamics-crm-2015online-2015-3854/
それでは今回はここまで。</description></item><item><title>Dynamics 365 ポータルアドオンの利用</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/use-dynamics-portal/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/use-dynamics-portal/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 Customer Engagement Plan アプリケーションには標準で、１つのポータルアドオンが提供されています。
ポータルを利用するメリットしては以下のようなことが挙げられます。
Dynamics 365 のライセンスを持たない組織外のユーザーに対しても、Dynamics 365 のデータを活用してサービスや情報の提供ができる Dynamics 365 のレコードの作成・編集のみで簡単に Web サービスの構築が行える 等のメリットが得られます。 引用元: Microsoft Dynamics 365 新機能: Portal アドオン その 1 今回は Dynamics 365 のポータルを使って、お問い合わせフォームを構成する手順をご紹介します。
Dynamics 365 ポータルのセットアップ Dynamics 365 ポータル機能については、上述したマイクロソフトのブログに詳しく記載されているため、ここでは割愛します。
なお、ここでは下図のように、顧客セルフサービスポータルをセットアップしました。
ページビューとライセンス Dynamics 365 Customer Engagement Plan でポータル機能を利用する上での制限として以下があります。
Dynamics 365 Customer Engagement Plan もしくはアプリケーション (Sales, CS, FS, PSA) のライセンスを合計で10シート必要 ページビューは 100万回/月 クラウドのみで利用可能。オンプレミスでは不可 引用元: Dynamics 365 ライセンス ガイド 無償版の Dynamics 365 を利用して検証する場合は、上記の制限を気にする必要はありません。</description></item><item><title>Dynamics 365 アプリの設定</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/dynamics-setting-application/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/dynamics-setting-application/</guid><description>Author:Takafumi Noguchi
linkedIn ここでは、Dynamics 365 のアプリケーションについてすこし触れていきます。
Dynamics 365 ではアプリケーションという機能が利用できるようになり、ユーザーのセキュリティロールによりアクセス可否を設定できるようになっています。
Dynamics 365 インストール直後だと、既定のアプリケーション、営業、サービスなどが作成されていますが、例えば、会社内の営業部隊には、営業というアプリケーションにアクセスさせることで、不要なエンティティやデータを事前に見せなくする、という管理も可能になります。
アプリケーションには、
サイトマップ ダッシュボード フォーム ビューグラフ 業務プロセスフロー が含まれています。
Dynamics 365 のメニューを開くと、下記のように利用できるアプリケーションが表示されます。
アプリケーションの表示名を変更する場合は、「設定」の「管理」より、「システムの管理」で変更することが可能です。
「システム管理」 を開きます。
「全般」 タブの 「既定のアプリ名」 で変更します。
各アプリケーションは、「システムのカスタマイズ」 にて設定が可能です。
「アプリ」 というコンポーネントがあるため、そこで既存のアプリケーションを変更することや、新規で作成することも可能になります。
「営業」 というアプリケーションを確認してみましょう。
ダブルクリックをすると、アプリ デザイナー が開きます。ここで、サイトマップやダッシュボード、エンティティの設定を行っていきます。
アプリケーションのサイトマップについては、下記の箇所から構成できます。サイトマップについては前回記載していますので、割愛します。
左下の ダッシュボード の「詳細」をドリルダウンすると、利用するダッシュボードが一覧化されています。営業のアプリケーションで利用するかどうかについては、右側のペインの 「コンポーネント」 にて設定が可能です。
業務プロセスにおいても同様です。
ここで少し話しを戻します。
そもそも なぜアプリケーションが必要なのか？ ということですが、これはある程度 Dynamics 365 を使って、社内外の CRM 開発を進めると実感するのですが、業務プロセスフローやダッシュボード、フォームやビューは、とにかくユーザーの要望に応じてどんどん増えていきます。
もし Dynamics 365 を複数の部署をまたいで利用する場合は、営業部門のビュー、マーケティング部のビューがビューのセレクターに一覧で表示されて、とても煩雑かつ使いづらくなってきます。
このようなことが起こることを事前に防ぐためにも、アプリケーションを利用して、各部署で利用するビューやダッシュボードだけを表示する工夫は事前に考慮が必要になります。
それでは、アプリ デザイナーに戻ります。
エンティティ では、現在のアプリケーションで利用されるエンティティが表示されています。新しくエンティティを追加する場合は、左上の ＋（追加）ボタン、もしくは、右ペインの 「コンポーネント」 から 「エンティティ」 をクリックすると、エンティティ追加画面になります。
基本はすでに作成されているエンティティを、新たに営業アプリケーションに追加するか、もしくは新しいエンティティを作成する、という作業になります。</description></item><item><title>Dynamics 365 インポートエラーの対処方法</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/dynamics-import-error/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/dynamics-import-error/</guid><description> Author:Takafumi Noguchi
linkedIn 前回の記事では、Excel テンプレートを使ったデータのインポート方法をお伝えしてきましたが、もしデータインポート時にエラーが発生した場合、どのように対処すればいいでしょうか。
どんな時にエラーがでるのか？ まず、テンプレートでエラーが出た際、最も多いのが、重複のデータによるエラーです。Excel テンプレートを見るとわかるのですが、参照フィールドの値は表示名をベースに入力するようになっています。
例えば、同じ名前の別の取引先企業に、それぞれ担当者を Excel テンプレートでインポートするとどうなるでしょうか？
行１ 取引先担当者名：テスト 太郎 取引先企業名：テスト 株式会社 行2 取引先担当者名：テスト 次郎 取引先企業名：テスト 株式会社 この「テスト 株式会社」はまったく別の会社です。通常、このような場合、参照する企業の内部IDなどで判断するはずですが、通常の表示名だけを見てしまうので、インポート時に以下のようなエラーが出てしまいます。
この場合、どう対処できるでしょうか？
１．インポート時のマッピング機能で対処する これは一番簡単な方法になりますが、インポート時に関連させるフィールドを、会社名ではなく、別のフィールドに変えてしまう方法です。例えば、会社の株式銘柄コードを利用する場合、先ほどのExcelテンプレートファイルに、会社名ではなく、それぞれの株式銘柄コードを入力します。
そして、Excel テンプレートファイルを再度インポートさせます。この際、フィールドのマッピングエディタを表示させる必要があるので、事前にExcelテンプレートに、適当な列を追加しておきます。（前回の記事を参照）
マッピングエディタで、今回重複のエラーが表示されていた、「会社名」を検索して、虫眼鏡のボタンをクリックします。
すると、マッピングする参照先を追加できます。この場合、新しく「株式銘柄コード」にチェックをいれて、「OK」をクリックしましょう。
あとはインポート処理を最後まで完了させます。すると、先ほどエラーになっていた箇所が、今回は成功しました。
正しくデータが作成されていますね。
2. レコードのIDを取得してインポートする 上記１の方法はとても有効ですが、マッピングエディタを使わずとも実施することができます。それは、それぞれの企業レコードのIDを取得してインポートする方法です。
今回重複エラーとなった企業をリストでチェックします。そしてメニューから「リンクを電子メールで送信」をクリックします。
するとメーラーのメール作成画面本文に、各レコードのURLが表示されるはずです。
ここで、id= から先のURLがレコードのIDになります。(先頭の %7b は無視します）
あとは、Excel テンプレートの「会社名」にIDを入力してから、ファイルを通常通りインポートしてください。
この方法の場合、マッピングエディタは不要なので、テンプレートに事前にカスタムの列を追加する必要がないので、とても便利です。
その他のエラーについて インポート時のエラーは重複に関することが多いのですが、その他のエラーについては、以下のコミュニティサイトなどを活用することで解決することがあります。
Dynamics 365 Community https://community.dynamics.com/
それでも解決しない場合は、サブスクリプション付帯のマイクロソフトサポートにお問い合わせをしてみてください。</description></item><item><title>Dynamics 365 Excel Onlineでデータインポート</title><link>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/import-data-from-excel-online/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/configure-initial-settings-for-dynamics-365/import-data-from-excel-online/</guid><description> Author:Takafumi Noguchi
linkedIn 前回までの記事では、インポート用のテンプレートを利用してデータをインポートする処理についてご紹介しました。この方法は、初期データをインポートする際にとても便利な機能になります。そして今回は、テンプレートを利用するのでなく、作成したビューをもとに、Excel Online で動的にデータをインポートする方法について記載していきます。
なお、Excel Online で動的に編集する際、ローカルPCに Excel クライアントがインストールされている必要はありません。
事前にビューをつくっておく Excel Online で動的にデータをインポートしたいエンティティを開いて、すぐに処理することも可能ですが、Dynamics 365 に5000件以上のレコードが格納されている場合、処理に時間を要することになります。そのため、事前にビューを作成して、そのビューに表示されるレコードを編集、もしくは新しいレコードを追加する方法をご紹介します。
ビューはシステムビューと個人用ビューの2種類がありますが、柔軟性を考慮して、個人用ビューを作成します。画面右上の「高度な検索」をクリックします。
「新規」ボタンをクリックして新しいビューを作成しましょう。
フィルター条件を設定します。ここでは、以下のような条件としました。
次に、「列の編集」をクリックして、表示させる列を選択します。選択された列が Excel Online でのインポートで値を編集、追加できるフィールドになるので、必要な列を選択します。必要な列にチェックを入れたら、「OK」をクリックします。
表示させる列の順番を変更したら、ここでも「OK」をクリックします。
「上書き保存」をクリックして、ビューの名前を設定後「上書き保存」をクリックします。
これで個人用ビューが作成されました。
Excel Online でデータのインポートを行う それでは、取引先企業を開いて、先ほど作成したビューを使いましょう。
ビュー一覧を開くと、「自分のビュー」に先ほど作成したビューが表示されていることがわかります。そのビューをクリックします。
すると結果がフィルター条件に合わせて絞られました。早速、Excel Online で編集します。メニューから「EXCEL にエクスポート」の ▼ をクリックして、「Excel Online で開く」をクリックします。
Excel 編集画面になりました。各列に必要な値を入力していきます。さらに新しい企業も追加します。
取引先企業名：株式会社エクセルインポート 代表者番号：029-186-6930 郵便番号：305-0062 住所：茨城県つくば市赤塚5-9-4 すべての編集と追加が完了したら、「変更を DYNAMICS365 に保存」をクリックしてデータをインポートします。
インポート用にデータが送信されるので、インポート処理の状態を確認して完了したら結果を確認します。
以下のようにレコードが更新されています。
このように、Excel でデータを管理するように、Dynamcis 365 ではレコードの追加や更新を行うことができます。 便利機能になるので、ぜひ使いこなしてみてください。</description></item></channel></rss>