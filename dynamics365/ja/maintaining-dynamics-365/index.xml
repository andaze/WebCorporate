<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>maintaining-dynamics-365 on My New Hugo Site</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/</link><description>Recent content in maintaining-dynamics-365 on My New Hugo Site</description><generator>Hugo -- gohugo.io</generator><language>ja-JP</language><atom:link href="https://andaze.com/dynamics365/ja/maintaining-dynamics-365/index.xml" rel="self" type="application/rss+xml"/><item><title>Dynamics 365 インスタンスの正常性</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/normality-of-instance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/normality-of-instance/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 の管理センターを操作して、インスタンスの管理を行ってきましたが、今度はインスタンスを運用する際に、そのインスタンスが正常に動作しているかどうかを管理する方法をご紹介します。
インスタンスの正常性確認 インスタンスの正常性確認を行う場合は、サービス正常性 を開きます。正常性　の列が「正常なサービス」となっていれば、インスタンスの正常性が保たれています。
インスタンスの記憶域の確認 使用記憶域についても確認できます。契約したサブスクリプション数により最初に利用可能な記憶域は異なりますが(※1)、足りない場合は追加購入することも可能です。(※2)
(※1) 初期の記憶域について
Dynamics 365 ライセンスガイドによると、既定では、10 GB が提供されており、フルユーザー (※1.1) が増えるにつれ、無償利用できる記憶域も増えます。(20 フルユーザーで 5GB の割合)
(※1.1) フルユーザー：Dynamics 365 Planまたは アプリケーション サブスクリプション (Dynamics 365 for Talent を除く) のライセンスを付与されたユーザー。Team Member は含みません。
参考情報：
Microsoft Dynamics 365 Enterprise エディション ライセンス ガイド
http://download.microsoft.com/download/5/6/0/560C4744-EF9F-4401-A620-12B5E9A520CB/Dynamics_365_Enterprise_edition_Licensing_Guide.pdf
(※2) 記憶域の追加購入について
記憶域の追加購入は、Office 365 管理センターから行います。下記の参考情報の手順を引用します。
記憶域の Dynamics 365 (オンライン) への追加
1 Office 365 管理センターを参照し、Office 365 グローバル管理者資格情報を使用してサインインします。
2 [請求] &amp;gt; [サービスの購入] の順にクリックする。 3 [サブスクリプションの追加] セクションまでスクロールし、[Dynamics 365 – 追加データベース ストレージ] タイルの上にマウス ポインターを移動します。 4 追加のオンライン ストレージの購入 5 [今すぐ購入] をクリックし、注文プロセスに移動します。</description></item><item><title>Dynamics 365 インスタンスのバックアップとリストア</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/backup-restore-instance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/backup-restore-instance/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics のインスタンスについてはこの記事が最後になります。この記事では、インスタンスのバックアップとリストアの方法をご紹介します。
インスタンスのバックアップ Dynamics 365 では、インスタンス単位でのバックアップが自動で取得されています。
取得頻度は1日1回、バックアップ保持期間は 3日分(最長) となっています。有効期限の切れたバックアップは自動的に削除されます。
バックアップを手動で取得する（オンデマンド　バックアップ） 手動でバックアップを取得する場合は、「新しいバックアップ」　をクリックして、バックアップを取得します。
自動バックアップと同様、有効期間は3日間となっており、有効期限が切れると自動で削除される仕組みとなっています。
バックアップを取得するインスタンスを選択して、「新しいバックアップ」をクリックします。
ラベルにバックアップ名を入力して、「作成」をクリックするとバックアップ取得が行われます。
バックアップが作成されました。有効期限を確認して、3日以上保持するのであれば、再度バックアップを取得してください。
バックアップの管理 作成したバックアップは、「編集」、「削除」、「復元」　を行うことができます。「編集」をクリックすると、バックアップ名を変更することができ、「削除」ではバックアップを削除することができます。
なお、「編集」、「削除」は、オンデマンド バックアップのみ有効です。システムで作成したバックアップは後述する「復元」しかできません。
インスタンスの復元 インスタンスの復元は、取得したバックアップの「復元」で実施可能です。
復元元が現在のバックアップであり、「復元先の選択」でバックアップを復元する先のインスタンスを選択します。なお、復元先として選択できるインスタンスは　サンドボックス　のみです。
「次へ」をクリックして、確認画面にて、「復元」ボタンをクリックすると復元が開始されます。
では、実稼働のインスタンス　をバックアップから復元する場合はどうすればいいのでしょうか。
実稼働インスタンスをバックアップから復元させる 実稼働インスタンスをバックアップから復元させるには、下記の方法を実施するといいでしょう。この方法は実稼働とサンドボックスの、最低でもインスタンスの２つが必要になります。
※復元作業を実施する場合は、ユーザーに影響がない時間を選択して、慎重に行う必要があります。
実稼働インスタンスとサンドボックス インスタンスをオンデマンド バックアップする
まず、インスタンスのバックアップを実稼働とサンドボックスの両方で取得しておきます。取得方法は バックアップを手動で取得する（オンデマンド　バックアップ） 上述した　のとおりです。 サンボボックス　インスタンスに、上記1. で取得した実稼働インスタンスのバックアップを復元する
実稼働インスタンスのバックアップを、まずサンドボックス インスタンスに復元します。もし実稼働の復元が正常完了しなかった場合は、修復まではサンドボックス インスタンスを利用することになります。 Consulting (実稼働)を復元元インスタンス、Dynamics Consulting (サンドボックス) 復元先インスタンスとしてバックアップを復元します。
上記2. が問題なく復元できた場合、実稼働インスタンスを　サンドボックスインスタンスに切り替える
実稼働インスタンスの「編集」から、インスタンスの種類を「実稼働」から「サンドボックス」に切り替えます。 インスタンスの種類を　「サンドボックス」　に切り替えます。「次へ」をクリックして、確認画面にて、「保存」ボタンをクリックします。
これで、実稼働だったインスタンスが、サンドボックス インスタンスに切り替わりました。
上記3.でサンドボックス　インスタンスに切り替えたインスタンスを、上記1.で取得した実稼働インスタンスのバックアップで復元する
これで、実稼働だったインスタンスの復元を行います。利用するバックアップは、1で取得したバックアップ（下記の例でいうと、Consulting のバックアップ）になります。ここでは、復元元、復元先の両方が Consulting インスタンスに選択されています。</description></item><item><title>Dynamics 365 をアップデートしよう</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/update-dynamics-instance-to-ver9/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/update-dynamics-instance-to-ver9/</guid><description>Author:Takafumi Noguchi
linkedIn 2017年7月に Dynamcis 365 version 9 (July 2017 update) がリリースされてしばらく経ちました。すでに試用版の Dynamcis 365 は version 9 になっており、version 8 を利用されている方は少数派？になってきているのではないかと思います。
実のところ、私の担当する顧客の Dynamics 365 は、つい最近まで version 8 で運用されていました。大きな理由として、スクリプトやAPI、その他サードパーティー製のソリューションなどを適用しているため、アップデートを計画的に実行するのに時間を要しました。
後述していますが、Dynamics 365 を計画的にアップデートすることは、顧客情報を守る上でとても重要な意味をもっています。そこで今回は、Dynamics 365 のアップデートの手順などについてご紹介していきます。
Dynamics 365 のアップデートについて まず、Dynamics 365 のメジャーアップデートはどのくらいの頻度で行われるのか、についてですが、公式には年に2回、春と秋に行われます。正式な月についてはリリースされるまで明示されませんが、最後のアップデートは July 2017 update であり、現在は、Spring 2081 update がリリースされるというアナウンスがされています。
Introducing the Dynamics 365 Spring 18 update!
https://cloudblogs.microsoft.com/dynamics365/2018/03/28/introducing-the-dynamics-365-spring-18-update/
現在の最新アップデートについては、以下の技術情報に記載されています。ここには、年に2回のメジャーアップデートと、年間に数回、自動で実施されるマイナーアップデートの情報が記載されいています。2018年6月時点では、9.0.2.0743 が最新となります。
Microsoft Dynamics 365 オンライン リリース
https://support.microsoft.com/ja-jp/help/2925359/microsoft-dynamics-crm-online-releases
Dynamics 365 のメジャーアップデートは必須なのか？ 年に2回もメジャーアップデートがありますが、実際に運用を始めているシステムのメジャーアップデートについては結構なインパクトがあります。以下の技術情報を読んでもわかる通り、アップデートによって追加される機能・廃止される機能があり、Dynamics 365 にスクリプトでのカスタマイズやポータル機能、ソリューションなどを利用している場合、アップデートにより動作しなくなる機能がないとも言えません。十分な検証が必要になります。
Dynamics 365 (オンライン) バージョン 9 の新機能 (Customer Engagement)</description></item><item><title>Dynamics 365 プロセスの作成</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/dynamics-365-process-use/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/dynamics-365-process-use/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 には、プロセスという機能により、ビジネスの手法をモデル化して特定の処理を自動化することができます。プロセスには主に4種類があります。（以下、技術情報より引用）
ワークフロー。 世界の現実のビジネス プロセスをモデル化および自動化するには、このプロセスを使用します。 これらのプロセスは、バックグラウンドまたはリアルタイムに実行されるように構成され、必要に応じてユーザー入力を必要することができます。 ワークフロー プロセスは、指定した条件に基づいて自動的に開始することも、ユーザーが手動で開始することもできます。 アクション。Microsoft Dynamics 365 標準のインストールで使用できない新しい操作を作成したり、異種複数の操作を単一の操作に組み合わせるために、このプロセスを使用します。 たとえば、サポート コール センターの場合、create、assign、および　setstate の操作を新しい単一の “エスカレート” 操作に組み合わせることができます。 業務プロセス フロー。 業務プロセス フローのビジュアル化を作成するには、このプロセスを使用します。 ユーザーは営業または顧客サービス プロセスのさまざまな段階から導かれます。 各ステージで、固有の手順を実行すると、次のステージに移動します。 ステップを追加または削除するか、ステージの順序を変更するか、またはプロセス フローに新しいエンティティを追加することで、プロセスのフローをカスタマイズできます。 ダイアログ。 開始および完了まで実行するためにユーザー入力を必要とする対話型の段階的のデータ入力フォームを作成するには、この手順を使用します。 ダイアログ プロセスを開始すると、ウィザード風のインターフェイスが表示され、ウィザードの各ページを進むにつれ、適切な選択またはデータの入力を行うことができます。
引用元： https://msdn.microsoft.com/ja-jp/library/gg309471.aspx
今回は、これらプロセスの中でも一番頻度高く利用されるワークフローについて触れていきましょう。
ワークフローの作成方法 まずは、ワークフローを作成します。「設定」メニューから「プロセス」をクリックします。
左上の「新規」ボタンをクリックすると、プロセス作成画面になります。まずは、プロセス名、プロセスの種類、対象となるエンティティなどを選択していきましょう。
今回の例では、
プロセス名：テストワークフロー０１ カテゴリ：ワークフロー エンティティ：取引先企業 種類：空のプロセスの新規作成 (※) このワークフローをバックグラウンドで実行する（奨励）：✔
として「OK」をクリックします。
(※) 種類では、テンプレートからプロセスを作成することも可能ですが、事前にプロセステンプレートを作成する必要があります。作成方法について後ほどご紹介します。
ワークフロー作成画面は以下の通りになります。各エリアを説明していきましょう。
① プロセスの種類を選びます。通常は「プロセス」ですが、「プロセス テンプレート」としてテンプレート化することもできます。テンプレートにする場合は、通常のプロセスとして実行などはできない点は注意が必要です。
② ワークフローをオンデマンド（手動実行）できるようにするかどうか、子プロセスとして実行させるかを選択します。 ③ ワークフローが実行されるスコープ（ユーザー・部署・部署配下・組織全体）と実行のトリガー（開始時期）を選択できます。 ④ ワークフローが正常に完了したらそのログを自動削除するかどうかを設定できます。多数のレコードにワークフローを実行すると、かなりの容量を使用することになるため、ここにはチェックをいれておくことが奨励されています。もしテストなどで結果を確認する場合は、一時的にチェックを外せばいいでしょう。 ⑤ 具体的なステップを作成する箇所です。条件やレコードの作成・更新・削除、割り当てなどを行うことができます。またサードパーティのツールをソリューションとしてインポートすれば、共有設定や、加算・積算などの簡易計算、上位エンティティから下位エンティティへプロセス実行などを幅広く行うことができるようになります。（こちらについては応用編でご紹介します）
それでは、今回はテストとして、レコード作成時に、取引先企業の「分類」フィールドを 顧客 に設定するシンプルなワークフローを作成してみましょう。
まずは、スコープは「組織全体」、開始時期を「レコードの作成」とします。それ以外は特に変更はしません。
そしてステップを追加します。「レコードの更新」を選択します。</description></item><item><title>Dynamics 365 プロセスの基本操作</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-more-of-workflow/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-more-of-workflow/</guid><description>Author:Takafumi Noguchi
linkedIn 前回の記事「Dynamics 365 プロセスの作成」は、プロセスのワークフローを作成する手順について触れてきましたが、今回はすこし応用編ということで、様々な用途について触れていきます。
レコードの更新をする 前回の記事では、レコードの更新を行う簡易な方法をお伝えしたので、今回は応用になります。
関連するレコードの値を更新する これは、レコードの更新のステップを追加後、更新するエンティティを変更して行います。以下の例だと、営業案件（下位エンティティ）から見て、取引先企業（上位エンティティ）のレコードを更新するステップになります。
手順は以下の通りです。
「ステップの追加」をクリックして、「レコードの更新」を選択 「更新：」にて “見込み顧客（取引先企業）” を選択 「プロパティの設定」をクリックして、取引先企業のフィールドで更新したい箇所を設定する。 なお、関連エンティティの更新は、下位エンティティから、上位エンティティに対して更新を行うものになります。つまり、営業案件から、取引先企業や担当者の項目を更新できますが、企業から見て、営業案件へ更新を行うことはできない。ということです。
※ もし変更する場合は、サードパーティー製のソリューションを利用する必要があります。
動的な値をフィールドにセットする 動的な値、例えば最終更新者やレコードのURLなどをフィールドに設定することも可能です。その場合は、プロパティの設定で、右側にある「フォーム アシスタント」から選択します。
手順は以下の通りです。
「プロパティの設定」ボタンをクリックして、動的な値を入れたいフィールドをクリック 「フォーム アシスタント」の「検索」にて、動的な値を利用したいエンティティとフィールドを選択 「追加」ボタンをクリックすると、値を下のボックスに記載されるので、「OK」をクリックしてフィールドに動的な値を追加。黄色の塗りつぶしで｛&amp;lt;フィールド名&amp;gt;(エンティティ名)｝ となれば、動的な値の設定が完了。 もしレコードのURLを取得したい場合は、「レコードURL」を選択します。
設定した値をクリアする これは、「フォーム アシスタント」の「演算子」で クリア を選択することで設定が可能です。設定すると｛クリア｝となります。
この場合、値は NULL になることは注意が必要です。もし はい/いいえ のリストで、いいえ を設定したい場合は、既定値で設定する必要があります。すると、｛いいえ｝という値が設定されます。
レコードの割り当て 「レコードの割り当て」というステップを追加すれば、そのレコードの所有者をワークフローで制御できます。
特定のユーザーを指定することもできますし、最終更新者 のような動的なユーザーを設定することも可能です。動的な値を設定する場合は、「プロパティの設定」を開き、「フォーム アシスタント」にて動的な値を設定します。
メールの送信 ステップの追加で、「電子メールの送信」を選択すると、顧客エンティティもしくはユーザーに対してメールを送信することができます。以下のように、差出人や宛先に、顧客エンティティやユーザーの情報を設定して、本文を設定することで、ワークフロー実行時に自動でメールが送付されるようになります。
差出人・宛先などについては、固定値も動的な値も設定が可能です。本文にメールのテンプレートを挿入することもできます。
なお、Dynamics 365 のメール送信は、メールアドレスを差出人に指定するのではなく、担当者やユーザーを差出人に設定して、そのレコードのメールアドレスにメールが送信されます。そのため、メールの送り先は、Dynamics 365 に登録されている顧客もしくはユーザー情報に限られますので、特定のメールアドレスに個別に送付、などの操作はできません。
子プロセスの実行 子プロセスの実行とは、同じエンティティで動く別のワークフローを呼び出して実行することができる機能です。このステップを利用する場合は、事前に同じエンティティで作成したワークフローが必要で、「子プロセスとして」のオプションを有効にしておく必要があります。
ステップにて、「子ワークフローの実行」をクリックします。
そして、事前に準備している子プロセスを選択します。（子プロセス、子ワークフロー、と表記が異なる理由は不明です。）
なお、子プロセスとして、操作しているプロセス自身を呼び出すことができます。これについては後述します。
Wait を利用した時間式ワークフローの実行 バッチ処理のように、毎時間もしくは毎日ワークフローを実行したい場合は、「待機時間」というステップを利用します。
これは、指定した期間、ワークフローの動作を待機させて、期間が過ぎると実行するようなステップになっており、さらのそのステップ後、同じプロセスを「子ワークフローの実行」で呼び出せば、手動で停止するまで、ワークフローが定期的に実行されるようになります。
なお、この手順の最初のトリガーは、オンデマンドで実行（手動実行）する必要があります。もし自動実行ができるような、まさにバッチ処理のような機能を求める場合は、サードパーティ製のソリューションが必要になります。
まず、「子プロセスとして」と「オンデマンド プロセスとして」のオプションを有効にします。
ステップで「待機状態」を追加します。
条件の設定において、以下のように設定します。
「プロセス」ー 「タイムアウト」ー 「が次の値と等しい」</description></item><item><title>Dynamics 365 業務ルールを使う</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-business-rules/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-business-rules/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 には業務ルールという機能があります。通常フォーム上でフィールドの非表示や条件に合わせた操作を行う場合は、Javascript の実装が必要になります。しかしこの機能を使用することで、スクリプト実装が不要となり、ユーザーが業務で必要なルールを簡易に設定できるようになります。
業務ルールでは以下のようなことが実現可能です。
条件とアクションを組み合わせることで、業務ルールを使用して以下の操作を実行できます
フィールド値を設定する フィールド値のクリア フィールドの入力要求レベルを設定する フィールドを表示または非表示にする フィールドを有効化または無効化するデータを検証し、エラー メッセージを表示する ビジネス インテリジェンスに基づくビジネス レコメンデーションを作成する 引用元：フォームにロジックを適用するために業務ルールおよびビジネス レコメンデーションを作成する
ここでは、業務ルールを使って簡単な操作を行っていきます。
業務ルールを作成する 「設定」の「カスタマイズ」を開き、「システムのカスタマイズ」をクリックします。
エンティティから「取引先企業」を展開して「フォーム」をクリックします。業務ルールを適用したいフォームを開きます。
メニューの「業務ルール」をクリックします。
右下に、「新しい業務ルールの追加」というボタンが表示されるので、クリックします。するとエディタが表示されます。ここで、必要な操作を行っていきます。
以下の図のように、コンポーネントとよばれるエリアに、フィールドのロックや非表示、エラーメッセージの表示などの要素が用意されており、条件にあった動作を行うことができます。
まずは条件を設定します。条件のコンポーネントをクリックすると、右側の「プロパティ」が開きますので、「表示名」や「ルール」を追加していきます。今回は以下のような条件とします。
表示名 企業の基本情報を入力する ルール１ 電子メール が空白である ルール２ Webサイト が空白である ルール ロジック かつ ルールを追加する場合は、「＋新規」をクリックします。設定が終われば「適用」ボタンをクリックしましょう。
新しい条件ができました。それでは、条件が TRUE の場合、エラーメッセージを表示させます。「コンポーネント」から「エラーメッセージの表示」を条件コンポーネントの右側にドラック＆ドロップします。
以下のように設定をします。
表示名 エラー表示 フィールド Webサイト メッセージ 企業情報を調べて入力してください。 設定したら「適用」をクリックします。
これで業務ルールが作成できました。「保存」をクリックして、ルールに問題がないかを検証します。何も問題が検出されなければ、「アクティブ化」をクリックしましょう。
フォームエディタに戻り、保存してカスタマイズを「公開」します。
それでは、業務ルールが適用されたかを確認しましょう。
Web サイト というフィールドにエラーメッセージが表示されていますね。
業務ルールを他のフォームに利用する 上記で作成した業務ルールを他のフォームでも同じような条件で利用したい場合はどうしたらいいでしょうか。業務ルールのスコープを設定しましょう。
業務ルールを開き、「非アクティブ化」をクリックして、編集可能にします。右上にある「スコープ」を確認します。スコープは以下のような範囲を設定できます。
エンティティ すべてのフォームとサーバー すべてのフォーム すべてのフォーム 特定のフォーム名 指定したフォームのみ すべてのフォームに適用する場合は、「すべてのフォーム」を選択しましょう。
もし、すべてのフォームではなく、2つのフォームのみという限定的な設定を行いたい場合は、一度この業務ルールを「ファイル名をつけて保存」で複製します。
業務ルールが複製されるので、そこでスコープを変更して、表示名の 「XXのコピー」の箇所を削除して保存すれば実現可能です。あとは「アクティブ化」をクリックして、別のフォームでも同じ業務ルールが有効になるように設定を完了させてください。</description></item><item><title>Dynamics 365 エンティティを管理する</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/create-new-entity/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/create-new-entity/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 のエンティティを作成・編集・削除などの管理方法をご紹介します。
エンティティについて Dynamics 365 では、ビジネスデータをエンティティでモデル化して管理しています。Dynamics 365 をセットアップすると既定で、取引先企業・取引先担当者・営業案件・活動という基本的なエンティティが用意されていますが、それぞれのエンティティで、企業情報・代表者情報・商談・商談の活動（電話・メール・予定・タスクなど）を管理しています。
また、組織に合わせてカスタムエンティティを作成して、既定のエンティティと関連付けることでビジネスデータを柔軟に管理できるようになります。
エンティティのコンポーネント エンティティには以下のコンポーネントが含まれています。
フォーム ユーザーがビジネスデータを閲覧・編集するためのユーザー インターフェイスです。フォーム内に項目（フィールド）を配置して、表示・非表示や既定値の設定などを業務ルールで設定します。Javascript を使ってコーディングすることも可能です。 ビュー ビジネスデータの一覧を表示するための機能です。エンティティに作成されている項目（フィールド）を列としてどのデータを一覧に表示させるか、どのようなフィルターをかけるかなどを設定できます。 グラフ エンティティのデータを使って、円グラフや棒グラフ、セールスファネルなどを作成できます。 フィールド ビジネス データを格納する入れ子です。開発者によっては属性（Attribute）と呼ばれるようです。 キー 代替キーと呼ばれる識別子を作成できます。外部データ ストアと統合する際などに必要になります。 関連付け エンティティと他エンティティの関連性を構成します。 メッセージ エンティティで利用されるメッセージです。システムですでに用意されており、編集可能です。 ビジネスルール 業務ルールです。フォーム内でも作成できます。 階層設定 同エンティティ内での階層設定です。取引先企業だと、親会社を設定すると階層ビューが表示されますが、そのビュー内で表示される企業の情報を変更できます。既定では「階層のタイルフォーム」が設定されています。 ダッシュボード 各エンティティのダッシュボードです。 参考情報
エンティティの代替キーの定義 システム エンティティ メッセージの編集 階層ビューでの取引先企業の関連付けの表示 階層ビューの例（取引先企業）
エンティティの作成 Dynamics 365 でカスタムエンティティの作成は、「システムのカスタマイズ」で行います。 ※ エンティティを作成する際は、設計と検証を行った上で作成してください。後述する削除手順にあるように、作成したエンティティを削除するとインスタンスに影響が出る場合があり、慎重な対応が必要です。不用意にエンティティを作成しないように注意してください。
エンティティ作成時の注意事項は公式ページにも記載があります。
ブラウザーに Safari を使用する場合、新しいユーザー定義エンティティを保存または公開しようとするとき、タイムアウト エラーが表示される場合があります。 このエラーが表示される場合、別のブラウザーを使用してエンティティを作成することをお勧めします。 エンティティ名で Dynamics 365 for Customer Engagement for Customer Service 埋め込みサポート情報検索を使用するために、発行者の接頭辞を含む最大エンティティ名の長さは 24 文字を超えてはなりません。 引用元： エンティティの作成</description></item><item><title>Dynamics 365 計算フィールドの活用</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-calculation-fields/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-calculation-fields/</guid><description>Author:Takafumi Noguchi
linkedIn 今回は、Dynamics 365 の計算フィールドについて簡単にご紹介していきます。
計算フィールドについて 計算フィールドは、Dynamics 365 のフィールドの種類で、以下のデータ型のフィールドで利用することができます。
1 行のテキスト オプション セット 2 つのオプション 整数 10 進数 通貨 日付と時間 計算フィールドを使うことで、If Else の条件によりフィールドの値を変えたり、関数により計算したり、ルックアップフィールドを介して関連性のあるエンティティのデータを取得することができるようになります。
また、計算フィールドで値や条件をセットすると、その設定はすべてのレコードに対して即時反映されます。オンデマンドプロセスのように手動ですべてのレコードに設定を反映させる必要がないのでとても便利です。
計算フィールドを作成 フィールドの新規作成画面に移動します。「データの種類」に上述したどれからの型を選び、「フィールドの種類」で “計算”
を選択します。すると「編集」というボタンが表示されます。このボタンをクリックすると、自動的にフィールドが作成されるので、「表示名」や「名前」は先に入力してクリックします。
「編集」をクリックすると、ポップアップが表示されます。ここで条件や値をセットします。
条件を設定 「条件の追加」をクリックすると、条件を設定できます。「エンティティ」でエンティティを選択します。計算フィールドを作成するエンティティにルックアップフィールドがあれば、関連するエンティティのフィールドを利用することも可能です。
ここでは “現在のエンティティ” にしておきます。「フィールド」は選択したエンティティのフィールドを選択でき、「演算子」で ＝ や ＞、NULL などを設定、「種類」では “値” もしくは “フィールド” を選択できます。
条件を設定したらチェックボタンをクリックしてください。
値を設定 「操作」により値を設定できます。「アクションの追加」をクリックします。この場合、上記で設定した条件が TRUE なら、この操作を行うということになります。ここでは = の後に、関数やフィールド、もしくは値を定義できます。
利用できる関数
ここで利用できる関数については以下を参照にしてください。
引用元：計算フィールドを定義して手動計算を自動化する
ここではテキストを入力しました。チェックボタンをクリックします。
別エンティティのフィールドを参照 「その他」（Else）の値として、別エンティティのフィールドの値をセットしてみます。「その他」を展開して「操作」から「アクションの追加」をクリックします。
営業案件に関連する「取引先担当者」（parentcontactidp）を利用します。
= に 「取引先担当者」フィールドの名前 parentcontactidp と ドット ( . ) を入力します。すると「取引先担当者」フィールドが候補として出てきます。
ここでは「氏名」を選択してチェックボックスをクリックしました。
このように、（取引先担当者）氏名 が設定されていることがわかります。</description></item><item><title>Dynamics 365 インスタンスの管理</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/manage-dynamics-instance/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/manage-dynamics-instance/</guid><description>Author:Takafumi Noguchi
linkedIn それでは Dynamics 365 の管理センターで何ができるかについて説明していきます。
インスタンスの管理 インスタンスでは、現在構成がされているインスタンス（実稼動およびサンドボックス(※1)）の管理、インスタンスのソリューションのインストールなどが行えます。プラン1　ライセンスの場合は、無償のサンドボックスインスタンスが提供されています。
（※2）
(※1) サンドボックスとは：
サンドボックス インスタンスは、Microsoft Dynamics 365 (オンライン)の非運用環境インスタンスです。 運用環境から独立しているので、サンドボックス インスタンスでは、アプリケーションの変更を、低リスクで安全に開発およびテストできます。
引用元： https://technet.microsoft.com/ja-jp/library/dn659833.aspx#BKMK_View
（※2）無償提供のサンドボックスインスタンスについて
Microsoft Dynamics 365 用 2016 年 12 月の更新プログラム (オンライン)で、無料サンドボックス インスタンスを受け取るための最低購買価格は必要とされません。 サブスクリプションを購入しても無料サンドボックス インスタンスを受け取っていない場合は、完全な Dynamics 365 Enterprise ライセンスを購入時に提供されます。 テナントごとに 1 つの無料のインスタンスという制限があります。 サンドボックス インスタンスを追加で購入することもできます。 詳細については、 「Microsoft Dynamics 365 価格設定とライセンス」を参照してください。
引用元：https://technet.microsoft.com/ja-jp/library/dn659833.aspx#BKMK_View
開発環境の構築方法 実稼動しているインスタンスを下に、開発環境を構築したい場合はどうすればいいか？
答えは単純です。
サンドボックスインスタンスにデータごとすべてコピーを行うことで、現時点の実稼動インスタンスのコピーを作成すればいいのです。構築方法はとてもシンプルです。
まず、Dynamics 365 管理センターより、インスタンスタブより実稼動インスタンス上をクリックします。
右メニューにある コピー ボタンをクリックすると、サンドボックスに現在のデータをコピーできます。
コピー先のインスタンスを選択して、完全なコピーか最小コピーかを選択して実行します。初回は「完全なコピー」を選択します。
(※ 100GB を超えるインスタンスのコピーについては、マイクロソフトサポートセンターにコピーを依頼する必要があります。)
インスタンスの完全および最小コピーについての詳細は下記の技術情報に記載があります。
インスタンスをサンドボックス インスタンスにコピーする
https://docs.microsoft.com/ja-jp/dynamics365/customer-engagement/admin/copy-instance#next-steps-after-copying-an-instance
インスタンスの完全なコピー 完全なコピーには、元のインスタンスのすべてのアプリケーション データ、ユーザー、およびカスタマイズが含まれ、以下の場合に適しています。</description></item><item><title>Dynamics 365 エンティティやオプションセットのカスタマイズ</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/customize-entity-option-sets/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/customize-entity-option-sets/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 メニューの「設定」-「システムのカスタマイズ」をクリックすると、下記の ソリューションエクスプローラー が開きます。
そして コンポーネント を展開するとカスタマイズ可能な一覧が表示されます。
ここで代表的なコンポーネントについて触れていきましょう。
エンティティ まずは エンティティ ですが、基本的なエンティティにかかわる設定はここで行うことができます。コンポーネントの「エンティティ」を展開すると、既定のエンティティがずらっと表示されます。（下記の画面左）
画面右上の 「ビュー」 を使えば、エンティティのフィルタリングをかけることができます。
ただ、見てのとおり、かなりの数のエンティティで既定の段階で作成されているので、目当てのエンティティを見つけることは容易ではありません。そのため、Ctrl + F の検索が一番便利な方法になります。
例えば、「取引先」 で検索すれば、すぐ確認できます。
エンティティの新規作成や削除、カスタマイズの公開はすべてボタンから行えます。またエンティティの依存関係を確認することもできます。
エンティティ内をさらに展開すると、エンティティに関する下記のカスタマイズが可能です。
フォーム ビュー グラフ フィールド キー 関連付け（1:N, N:1, N:N） メッセージ 業務ルール 階層設定 ダッシュボード ここでは、ひとつひとつ具体的には触れませんが、エンティティのレコードを作成、表示、編集するためのページレイアウト（フォーム）のカスタマイズや、レコードを表示させるビュー、他のエンティティのレコードと関連付け、ある一定のルールに従い、必須項目や表示非表示を変化させる（業務ルール）ことなどを細かく設定できます。
オプションセット オプションセットとは、選択リストのマスター値を作成して利用できます。こちらも既定でかなりの数のオプションセットが用意されていますが、新規でオプションセットを作成して、複数個所で同じオプションセットを利用したい場合に便利です。
作成したオプションセットは、エンティティのフィールドで選択することができます。フィールドの新規作成画面で、オプションセットを新規作成もできます。
クライアント拡張 ソリューションの機能や実用性を拡張するために使われるコンポーネントですが、プラグインなどを利用して本格的なカスタマイズを行わない限りはあまり利用しないかもしれません。ただ、前回の記事 でふれたサイトマップの編集はここから行います。
上記 「サイト マップ」 をダブルクリックすると、サイトマップ エディタ が開きます。
サイトマップ エディタを使えば、エリア・グループ・サブエリアの細かい編集が可能です。（以前は、sitemap.xml ファイルをエクスポートしてから、編集する必要がありとても大変でした。）
例えば、エリアをクリックすれば、細かいプロパティを編集できます。アイコンを変えたい場合は、次に紹介する 4. Web リソース に画像ファイルを追加すれば、アイコンの変更も可能です。
なお、下記の参考情報の引用にあるように、アイコンのサイズは決まっていますのでご注意ください。
CRM 2015 SP1 より後では、&amp;lt; Area &amp;gt; (SiteMap) のアイコンは、不透明度 18% の白色の 85×71 (高さ x 幅) ピクセルのイメージです。&amp;lt; SubArea &amp;gt; (SiteMap) メニューでは、エンティティのアイコンとして、32×32 ピクセルのイメージが使用されます。</description></item><item><title>Dynamics 365 のWebリソースやプロセスのカスタマイズ</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/customize-web-resource-process/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/customize-web-resource-process/</guid><description>Author:Takafumi Noguchi
linkedIn 前回の記事では、システムのカスタマイズより「エンティティ」や「オプションセット」についてふれてきました。その他のカスタマイズはどのようなことができるのでしょうか？
今回は、Webリソース、プロセス、ダッシュボード、レポートについて概要をご紹介します。
Webリソース Web リソースでは、Dynamics 365 で利用するアイコンなどの画像ファイルから、HTML ファイル、Javascript、CSS、XML や Silverlight アプリケーションなどを作成することができます。Web リソースで作成したコンテンツについては、各エンティティのフォームやサイトマップなどで利用することができます。
実際に、新規作成画面を開いてみましょう。
Web リソースの名前や表示名を設定していきます。Dynamics 365 では、Web リソースやフィールドをカスタムで作成するとき、必ず名前の頭に “new_” がつきます。下記の画面の通り、Web リソースとして登録できるコンテンツの種類は決まっています。(※)
(※) コンテンツの種類 Web ページ (HTML)： .htm, .html スタイル シート (CSS)： .css スクリプト (JScript) ： .js データ (XML)： .xml イメージ (PNG)： .png イメージ (JPG)： .jpg イメージ (GIF)： .gif Silverlight (XAP)： .xap スタイルシート (XSL)： .xsl, .xslt
イメージ (ICO)： .ico
制限事項として、Webリソースで作成できるコンテンツは上記以外なく、ASP.NET(.aspx) ページは登録できません。また、アップロードできるファイルの最大サイズは、既定で 5MB と決まっています。詳しくは、下記の参考情報をご確認ください。
サイズ制限
アップロードできる最大ファイル サイズは、Organization.MaxUploadFileSize プロパティによって決まります。 このプロパティは、Dynamics 365 アプリケーションの [システム設定] の [電子メール] タブで設定します。 この設定で電子メール メッセージ、メモ、および Web リソースに添付できるファイルのサイズを制限します。 既定の設定は 5 MB です。 引用元: Microsoft Dynamics 365 の Web リソース</description></item><item><title>サードパーティ製のおすすめソリューション</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/whats-3rd-party-solutions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/whats-3rd-party-solutions/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 には、機能を補助・補強するようなソリューションが多く提供されていることが魅力ですが、どのようなソリューションが Dynamics 365 の機能をさらに拡張してくれるのでしょうか。
今まで利用したソリューションで特にインストール後の効果が高かったものを今回はご紹介します。
(※注意) サードパーティ製ソリューションは、マイクロソフトが必ずしも動作保証をしているソリューションではありません。本ブログではあくまでも情報共有となりますので、ご自身の環境でインポートされる際は、十分な検証のもと、自己責任にてインポートを行ってください。
Metadata Browser https://docs.microsoft.com/ja-jp/dynamics365/customer-engagement/developer/browse-your-metadata
このソリューションを活用すると、Dynamics 365 にあるすべてのエンティティとフィールドの詳細情報を簡易に確認することができます。特にフィールドを検索する場合は、Metadata Browser なしでは作業効率が明らかに異なります。
例えば、以下のように取引先企業のフィールドが一覧で表示されて、検索もできますし、左のパネルにはフィールドのデータ型や制限なども記載されています。「Edit Attribute」をクリックすれば、フィールドのプロパティ画面へ遷移できることも便利な理由です。
Ribbon Workbench https://www.develop1.net/public/rwb/ribbonworkbench.aspx
リボンワークベンチは、Dynamics 365 のボタンのカスタマイズには欠かせないソリューションです。カスタマイズの知識は多少必要になりますが、ボタンの非表示・非表示、名前の変更、ボタンを追加やアクションの追加を行うことが可能になります。
Dynamics 365 は多くのボタンがメニューに表示されており、表示・非表示の柔軟性はあまりないので、このソリューションはぜひとも追加したいところです。
さらにRibbpn Workbenchは、Smart Buttons という追加ソリューションを Github に公開しています。
Smart Buttons v1.2.88.1 https://github.com/scottdurow/RibbonWorkbench/releases
この機能はとても便利で、Dynamics 365 で作成したプロセス（ワークフロー）をボタンに設定して、クリック時にオンデマンドで起動させることや、Javascript や レポートを起動させることも可能になります。
Dynamics 365 Workflow Tools https://archive.codeplex.com/?p=msdyncrmworkflowtools
これはすでにCodePlex　でアーカイブされていますが、ワークフローの機能を拡張できる便利なソリューションです。通常ワークフローでは、レコードに対してチームやユーザーの共有設定を行うことができません。それをこのソリューションは可能にします。
また、フィールドの加算や積算、オプションセットの値の追加・削除、データの複製など、もっとこんな機能があれば、プロセスは便利なのに！という要望をかなりの範囲で網羅しています。
ソリューションをインポートすると、ステップの追加で利用できるようになります。
crm2011distributewf https://archive.codeplex.com/?p=crm2011distributewf
こちらも、すでにCodePlexでアーカイブされているソリューションですが、1:N や　N:N の下位のエンティティに対してプロセスが実行できる優れものです。
例えば、テスト企業に、太郎、次郎、三郎　という担当者が3名いる会社情報があったとします。テスト企業の住所が変わると、その下位である太郎、次郎、三郎のレコードの勤め先住所というフィールドを更新したいと考えたとき、通常のプロセスでそれを実現することは不可能でした。
しかしこのソリューションは、1:N の関連付けもしくは　N:N 関連の関連付けのスキーマ名（account_master_account　など）と、下位のプロセスがあれば上記のような、上位エンティティから下位エンティティへのプロセスを実行することが可能になります。
ソリューションをインポートすると、ステップの追加に　AG Utilities が追加されます。</description></item><item><title>ワークフロープロセスの無限ループ対策</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-workflow-process-loop/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-workflow-process-loop/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 のワークフロー プロセスはコーディングなしでもデータの更新や作成・削除から割り当て、メール送信など多くのことを実行できる便利な機能です。既定のワークフロー プロセスだけでなく、Workflow Heroesにあるようなサードパーティー製のワークフローソリューションをインポートすれば、レコードの共有設定や日付・10進数の四則演算など、ユーザーの多くの要望をワークフロー プロセスで実現できるようになります。
ただ、こんな便利なワークフロー プロセスにおいても制限事項があります。特に運用で一番インパクトがあったのが無限ループを回避するための制限でした。
下記の技術情報にあるように、特定のレコードに対してプロセスが一定回数実行されると、無限ループとして検出されて「失敗」してしまいます。
無限ループの回避 ・・・作成するワークフローには、無限ループを検出して停止するためのロジックが含まれます。 ワークフロー プロセスが、短時間に特定のレコードに対して一定の回数を超えて実行されると、次のエラーでそのプロセスは失敗します。このワークフロー ジョブは、それを開始したワークフローに無限ループが含まれるので取り消されます。ワークフロー ロジックを修正して、もう一度やり直してください。 回数の上限値は 16 です。
引用元： ワークフロー プロセスに関するベスト プラクティス
この制限事項には結構手を焼きまして、いろいろ試行錯誤して、どのタイミングで「失敗」してしまうのかがわかってきたので、その対策を含めてご紹介します。
どういったときにループを使うのか？ まずワークフロー プロセスをどういったときに使うか。私はよく上位下位関係のあるエンティティのレコードを上位から下位に対して一括更新する時や、前後関係のあるレコードの一部を削除した際、後続するレコードを更新する時などに使います。
例えば、下図のように営業案件に複数の活動が関連しており、これらの活動を開始の日付が古い順に番号を振りたいとします。
ここで、営業活動側でロールアップフィールドを作成して、活動で開始が一番古い（MIN）の日付を持ってきて、 その日付と一致した活動は一番古いだと判別できます。
上位から下位に対して日付が一致しているかどうかと番号を付与するプロセス、Ultimate Workflow Toolkit の 「Distribute Workflow」 を使って処理して行いました。
この営業案件のフィールドを更新する処理を活動数分繰り返すのですが、営業案件にぶら下がる活動数が多い場合、簡単に16回の制限を超えてしまうので、プロセスが無限ループとして検出され「失敗」します。
実行できるループの回数 １プロセス内の１ステップでレコードの更新を行い、その後に「子ワークフローの実行」で同プロセスを再度呼んでループを繰り返す検証を行ったところ、実際は15回目で「失敗」となりました。
そして、レコードの更新が行われたのは、14回でした。（15回目の更新時に、無限ループ検出されている）
そのため公式ドキュメントで記載されている16回よりも実際は少ないようです。（なぜかは不明）
次に、1 プロセスのステップで、レコードを複数回更新した場合、16 回以上のレコード更新を行うことができるかの検証しました。
1 プロセスに 4 ステップを追加して、営業案件レコードを更新後、同プロセスをループするようにしました。
この場合でも、15 回目で「失敗」となりました。
ただ、1 プロセス内でレコードを4回更新しているので、14 回 (成功したプロセス実行数) x 4 ステップ = 48回 レコードが更新されたことになります。最初の検証とは大きな違いです。1 プロセスのステップ数を増やせば、より多く更新することができるはずです。
これらの検証より、制限ギリギリまでループを実行したい場合は、1プロセス内でステップを多く活用して、同プロセスをループする方法が最適だとわかりました。
どのように対策をしたらいいか？ ただ、どんなに工夫をしてもループ回数制限にはひっかかります。どのようにループ回数制限とうまく付き合えばいいか。試行錯誤した結果、この方法であればうまくいくことがわかりました。 （あくまで個人的なアイディアです。もし他にいい方法があればコメントください）</description></item><item><title>メジャーアップデート適用方法の変更【2019.08】</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/changed_update_policy/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/changed_update_policy/</guid><description>Author:Takafumi Noguchi
linkedIn 正直に言うと、Dynamics 365 メジャーアップデートは運用・保守部門泣かせなアップデートだと思っています。
アップデートに対応するために
インスタンスがアップデート対象になるのを待ち インスタンスがアップデート対象になれば、サンドボックスで検証するためにアップデート候補日を設定。 候補日が予定通り実行されないケースを想定して、スケジュールを２つ作って備える サンドボックスアップデート後、検証開始。検証が無事に終われば、本番適用。 ユーザー利用の少ない土日を使って、アップデート後の検証作業を実施 アップデート後は、ヘルプデスクに運用を移管。必要に応じてユーザー対応 少なくともこれだけの準備とリソースが必要な上、年に2回もアップデートがある。これはもう “イベント” です。
しかし気づけば、このメジャーアップデートの方法がいつの間にか変更されました。今までのようにユーザーでスケジュールを計画してアップデートを実行するのではなく、有無を言わさず実行されるようになりました。
なぜこのような変更がされたのか？公式ドキュメントでは、今回の変更の理由をこのように述べています。
これらの変更を行う理由は何ですか? すべての顧客のエクスペリエンスがさらに一貫し、予期可能で、シームレスなものになるように、Dynamics 365 の更新プログラムの配布方法を最適化しています。 新しい定期更新では、アップグレードのコストを下げ、すべてのユーザーが最新の製品機能にアクセスできるようにしてパフォーマンスを向上させ、サポート エクスペリエンスを改善することを目指しています。
引用元： Dynamics 365 の更新ポリシーに関する FAQ
…と言われても、運用・保守からすると不安です（笑）
カスタマイズレスな環境でも、アップデート直後は問題なく使用できるという保証はないですし、スクリプトなどで少しでもカスタマイズを入れている場合は影響範囲の検査は必須です。さらに、ちょっとした見た目の変化や操作感に、ユーザー部門は敏感なため、「見た目がいつもと違う」などの細かいお問い合わせが増えることも想定しておく必要があります。
ただ、不満ばかり述べても意味がなく、この変更は決定事項なので、「どのように対処するか」について今回はご紹介しようと思います。
メジャーアップデートについて まずは Dynamics 365 のメジャーアップデートに関する基本的な情報です。
メジャーアップデートとは何か？ メジャーアップデートは年に2回 (4月と10月) にあり、Dynamics 365 Customer Engagement アプリケーション（Sales, CS, Field Service, PSA, Marketing) が対象になっています。バージョン 8.2 から 9へのアップデートもこのメジャーアップデートでした。
参考情報： Dynamics 365 の更新ポリシーに関する FAQ
いつアップデートされるか？ 公式ドキュメントのスケジュールによると、2019 年 10 月 1 日から一般公開になっており、日本は 2019年10月11日 から 10月13日 の間に実行されるようです。</description></item><item><title>設定のサイトマップを調整する</title><link>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-privilege-to-settingsitemap/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://andaze.com/dynamics365/ja/maintaining-dynamics-365/use-privilege-to-settingsitemap/</guid><description>Author:Takafumi Noguchi
linkedIn Dynamics 365 のアプリを作成すると、現在は Power Apps との統合もあり、統一インターフェイス （モバイル駆動アプリ）として作成されます。ここで、詳細設定を一般ユーザーも開くことができるのですが、この「設定」について細かな調整ができることがわかったので記載しておきます。
一般ユーザーでも見えてしまう設定メニュー ほとんど権限のないような一般ユーザーでも、
ページ右上の歯車から「詳細設定」をクリックすると、
「設定」のメニューが表示されてしまいます。
特に「セキュリティ」は、一般ユーザーが見えなくていい箇所なのですが、見えないようにするにはセキュリティロールのユーザーや部署などの権限を調整しなくてはいけないのでそれなりに面倒です。
セキュリティロール設定で歯車を非表示にできればいいんですが、そういった手法はサポートに確認してもできないという回答だったので、「設定」内の表示自体を更新する必要があります。
サブエリアに特権を追加する この問題については、サイトマップとエンティティへの特権で解決できます。
まず、カスタマイズのクライアント拡張より「サイトマップ」を開きます。
サイトマップの「設定」のエリアまで移動して、現在一般ユーザーに表示されているサブエリアをクリックします。ここでは「セキュリティ」をクリックします。
右側のプロパティが開くので、詳細設定の「特権」を開き、エンティティで “SettingsSiteMap” を検索して、横の ＋ ボタンをクリックします。
すると対象エンティティに、SettingsSiteMap が追加されます。ここで必要な権限にチェックを入れていきます。今回は「すべて」の状態で保存して公開しました。
これはつまり、ユーザーが設定されているセキュリティロールの「SettingsSiteMap」において、作成から割り当てまですべての権限を持っている必要がある設定になります。
サイトマップの設定はこれでOKです。
動作確認 セキュリティロールを１つ選択して、「ユーザー定義エンティティ」タブを開き、SettingsSiteMap を探します。SettingsSiteMap は “選択なし” か “組織全体” の２択です。まずは “選択なし” で動作確認をします。
一般ユーザーで確認してみると、「設定」に “セキュリティ” が表示されなくなりました。
セキュリティロールに戻り、すべてを “組織全体” にして保存しました。
確認すると、セキュリティ… 以外も見えるようになりました（笑）
「設定」のサブエリアで上記と同じような特権の設定がされていたものがあったようです。
意外と知らない機能だったので簡単にまとめてみました。
今回はここまで！</description></item></channel></rss>