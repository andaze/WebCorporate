var scene=new THREE.Scene,renderer,camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3);camera.position.z=260,camera.position.x=0,camera.position.y=20,renderer=new THREE.WebGLRenderer,renderer.setSize(window.innerWidth,window.innerHeight);const wrapper=document.querySelector("#webgl");wrapper.appendChild(renderer.domElement);const geometry=new THREE.BufferGeometry,img=new Image;img.src="img/logo_2_min.png",img.crossOrigin="anonymous",img.addEventListener("load",()=>{var h=k(img,img.width,img.height,2),e,u,p,m,v,g,t,s,r,n,o,d,l;const T=new THREE.BufferAttribute(new Float32Array(h.position),3),E=new THREE.BufferAttribute(new Float32Array(h.color),3),A=new THREE.BufferAttribute(new Float32Array(h.alpha),1),x=[],a=h.position.length/3;for(let e=0;e<a;e++)x.push((Math.random()-1)*2,(Math.random()-1)*2);const z=new THREE.BufferAttribute(new Float32Array(x),2),w=[];for(let e=0;e<a;e++)w.push(1);const D=new THREE.BufferAttribute(new Float32Array(w),1);geometry.setAttribute("position",T),geometry.setAttribute("color",E),geometry.setAttribute("alpha",A),geometry.setAttribute("rand",z),geometry.setAttribute("flag",D);const N=new THREE.RawShaderMaterial({vertexShader:document.querySelector("#js-vertex-shader").textContent,fragmentShader:document.querySelector("#js-fragment-shader").textContent,uniforms:{u_ratio:{type:"f",value:0},u_time:{type:"f",value:0},move_param:{type:"i",value:0}},transparent:!0});e=new THREE.Points(geometry,N),e.position.x=0,u=e.geometry.attributes.position;const i=e.geometry.attributes.alpha.array,R=e.geometry.attributes.color.array,c=e.geometry.attributes.flag.array;m=0,g=0,s=new THREE.Vector2,r=new THREE.Vector2,n=new THREE.Vector2,o=new THREE.Vector2,d=!1,l=!1,scene.add(e),M(3),window.setTimeout(F,4*2e3),window.setTimeout(f,4*2e3),typeof window.ontouchstart=="undefined"?(renderer.domElement.addEventListener("mousedown",_),renderer.domElement.addEventListener("mouseup",y)):(renderer.domElement.addEventListener("touchstart",_),renderer.domElement.addEventListener("touchend",y)),b(),C(),window.addEventListener("resize",C);function k(h,d,l,o){const s=document.createElement("canvas"),i=s.getContext("2d"),t=d,n=l;s.width=t,s.height=n,i.drawImage(h,0,0);const u=i.getImageData(0,0,t,n).data,a=[],r=[],c=[];for(let s=0;s<n;s+=o)for(let i=0;i<t;i+=o){const l=(s*t+i)*4,d=i-t/2,h=-(s-n/2),m=0;var e=[0,255];const f=e[Math.floor(Math.random()*e.length)],p=e[Math.floor(Math.random()*e.length)],g=e[Math.floor(Math.random()*e.length)],v=u[l+3]/255;a.push(d,h,m),r.push(f,p,g),c.push(v)}return{position:a,color:r,alpha:c}}function L(n){for(var e=0,t;e<a;e++)i[e]>0&&(i[e]=.5**6);for(e=0;e<n;e++)for(t=0;t<a;t++)random=t+Math.floor(Math.random()*2)+1,i[random]>0&&(i[random]=.5**(e+7))}function S(t){for(let s=0;s<a;s++){var n={x:i[s],y:c[s]},e=new TWEEN.Tween(n);e.to({x:1,y:1},3e3);for(j=0;j<t;j++)i[s]===.5**(j+6)&&(e.delay(j*2e3),e.start());e.onUpdate(function(e){i[s]=e.x,c[s]=e.y})}}function M(e){L(e),S(e+1)}function F(){d==!1?d=!0:d=!1}function f(){l===!1?l=!0:l===!0&&(l=!1)}function O(){v=setTimeout(function(){m=Date.now()-p+g,O()},10),t=m/1e3}function _(e){e.preventDefault(),s.x=e.clientX-window.innerWidth/2,s.y=-(e.clientY-window.innerHeight/2)+camera.position.y,typeof window.ontouchstart!="undefined"&&(s.x=e.changedTouches[0].pageX-window.innerWidth/2-20,s.y=-(e.changedTouches[0].pageY-window.innerHeight/2)+20+camera.position.y),p=Date.now(),O()}function y(_){_.preventDefault();const w=e.geometry.attributes.position.array;if(r.x=_.clientX-window.innerWidth/2,r.y=-(_.clientY-window.innerHeight/2)+camera.position.y,typeof window.ontouchstart!="undefined"&&(r.x=_.changedTouches[0].pageX-window.innerWidth/2-20,r.y=-(_.changedTouches[0].pageY-window.innerHeight/2)+20+camera.position.y),n.x=r.x-s.x,n.y=r.y-s.y,o.x=Math.abs(n.x),o.y=Math.abs(n.y),d==!0)for(let e=0;e<a;e++){var F=u.getX(e)*(500/camera.position.z)-8,j,y,h,E,k,O,x,i,b,M=u.getY(e)*(500/camera.position.z)+8,S={x:u.getX(e),y:u.getY(e),z:c[e]},C={x1:camera.position.x,y1:camera.position.y,z1:camera.position.z,x2:camera.rotation.x,y2:camera.rotation.y},A=Math.sqrt(Math.pow(F-s.x,2)+Math.pow(M-s.y,2));if(c[e]===1)if(A<10/(t*6)&t>.01){if(c[e]=0,n.x>0&o.y<20)j=1,y=0,h=Math.floor(Math.random()*50+1-40)+40;else if(n.x<0&o.y<20)j=-1,y=0,h=Math.floor(Math.random()*50+1-40)+40;else if(n.y>0&o.y>=20)j=0,y=1,h=Math.floor(Math.random()*50+1-40)+40;else if(n.y<0&o.y>=20)j=0,y=-1,h=Math.floor(Math.random()*20+1-10)+10;else if(o.x<5|o.y<5)return;E=h*j,k=h*y,O=w[3*e]+E+n.x/(t*20),x=w[3*e+1]+k+n.y/(t*20),i=new TWEEN.Tween(S),i.to({x:O,y:x,z:0},t*3e4),i.easing(TWEEN.Easing.Quadratic.Out),i.onUpdate(function(t){w[3*e]=t.x,w[3*e+1]=t.y,c[e]=t.z}),i.repeat(1),i.yoyo(!0),b=new TWEEN.Tween(C),b.to({x1:O/(t*1e3),y1:x*-1/(t*1e3),z1:camera.position.z-2e3/(t*300),x2:x/1e3*-1,y2:O/1e3*-1},t*1e5),b.delay(2e3),b.onUpdate(function(e){camera.position.x=e.x1,camera.position.y=e.y1,camera.position.z=e.z1,camera.rotation.x=e.x2,camera.rotation.y=e.y2}),b.repeat(1),b.yoyo(!0),i.start(),l===!0&&(b.start(),f(),window.setTimeout(f,t*1e5*2+4e3))}}clearTimeout(v),g+=Date.now()-p,m=0,g=0}function b(){requestAnimationFrame(b),renderer.render(scene,camera),e.material.uniforms.u_time.value+=.1,TWEEN.update(),e.geometry.attributes.alpha.needsUpdate=!0,e.geometry.attributes.position.needsUpdate=!0,e.geometry.attributes.flag.needsUpdate=!0}function C(){const e=window.innerWidth,t=window.innerHeight,n=780,s=585;e>=n?camera.position.z=260:e<n&e>=s?camera.position.z=360:camera.position.z=480,renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(e,t),camera.aspect=e/t,camera.updateProjectionMatrix()}})