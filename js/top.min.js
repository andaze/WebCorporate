var scene=new THREE.Scene,camera,renderer;const width=window.innerWidth,height=window.innerHeight;camera=new THREE.PerspectiveCamera(75,width/height,.1,1500),camera.position.x=0,camera.position.y=30,renderer=new THREE.WebGLRenderer;const header_height=document.getElementById("header_nav").clientHeight;renderer.setSize(width,height-header_height);const wrapper=document.querySelector("#webgl");wrapper.appendChild(renderer.domElement);const geometry=new THREE.BufferGeometry,img=new Image;img.src="../img/logo.png",img.crossOrigin="anonymous",img.addEventListener("load",()=>{var e,s,i,r,c,l,u,m,f,p,g,v,O,C,E,k,S,M,F,T,z,D,N,L,R,P,H,I,B,V,$,X,J,h=eh(img,img.width,img.height,2);const e4=new THREE.BufferAttribute(new Float32Array(h.position),3),e1=new THREE.BufferAttribute(new Float32Array(h.color),3),ei=new THREE.BufferAttribute(new Float32Array(h.alpha),1),Y=[],a=h.position.length/3;for(let e=0;e<a;e++)Y.push((Math.random()-1)*2,(Math.random()-1)*2);const ea=new THREE.BufferAttribute(new Float32Array(Y),2),W=[];for(let e=0;e<a;e++)W.push(1);const er=new THREE.BufferAttribute(new Float32Array(W),1),G=[];for(let e=0;e<a;e++)G.push(0);const ec=new THREE.BufferAttribute(new Float32Array(G),1);geometry.setAttribute("position",e4),geometry.setAttribute("color",e1),geometry.setAttribute("alpha",ei),geometry.setAttribute("rand",ea),geometry.setAttribute("flag",er),geometry.setAttribute("colorChangeFlag",ec);const et=new THREE.RawShaderMaterial({vertexShader:document.querySelector("#js-vertex-shader").textContent,fragmentShader:document.querySelector("#js-fragment-shader").textContent,uniforms:{u_ratio:{type:"f",value:0},u_time:{type:"f",value:0},u_value:{type:"f",value:0},pointTexture:{value:(new THREE.TextureLoader).load("../img/triangle.png")}},transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1});e=new THREE.Points(geometry,et),s=e.geometry.attributes.position;const w=e.geometry.attributes.alpha.array,t=e.geometry.attributes.color.array,o=e.geometry.attributes.position.array,d=e.geometry.attributes.flag.array,b=e.geometry.attributes.colorChangeFlag.array,y=4,_=500;R=0,N=0;const e0=new THREE.Clock;B=[],H=new THREE.Raycaster,C=new THREE.Vector2(-2,-2),p=new THREE.Vector2,O=new THREE.Vector2,c=new THREE.Vector2,f=new THREE.Vector2,D={x1:e.position.x,y1:e.position.y,z1:e.position.z,x2:e.rotation.x,y2:e.rotation.y,z2:e.rotation.z},u=new THREE.Vector2,l=new THREE.Vector2,S=new THREE.Vector2,i=new THREE.Vector2,k=new THREE.Vector2,M=new THREE.Vector2,g=new THREE.Vector2,F=new THREE.Vector2,V=new THREE.Vector2,T=new THREE.Vector2,E=!1,v=!1,P=!1,L=!1,z=!1,scene.add(e),B.push(e),window.setTimeout(()=>{es(y-1,_),window.setTimeout(eo,y*_),window.setTimeout(A,y*_)},500),e2(),typeof window.ontouchstart=="undefined"?(renderer.domElement.addEventListener("mousedown",Z),renderer.domElement.addEventListener("mouseup",U)):(renderer.domElement.addEventListener("touchstart",Z),renderer.domElement.addEventListener("touchend",U)),ee(),K(),$=window.innerWidth,J=window.innerHeight,window.addEventListener("resize",function(){if($==window.innerWidth&typeof window.ontouchstart!="undefined"){J<window.innerHeight?nav_block.style.bottom=height*.15+80+"px":nav_block.style.bottom=height*.15+"px";return}$=window.innerWidth,K()}),e3(),window.setTimeout(()=>{window.setInterval(eu,1e3),window.addEventListener("blur",()=>{z=!0}),window.addEventListener("focus",()=>{z=!1})},y*_+5e3+n(5,1)*1e3),window.setTimeout(()=>{el()},y*_+5e3+n(5,1)*1e3+15e3),window.setTimeout(()=>{Q(),window.setInterval(Q,4e4)},5e3);function eh(h,u,d,o){const n=document.createElement("canvas"),i=n.getContext("2d"),e=u,t=d;n.width=e,n.height=t,i.drawImage(h,0,0);const l=i.getImageData(0,0,e,t).data,c=[],a=[],r=[];for(let n=0;n<t;n+=o)for(let i=0;i<e;i+=o){const h=(n*e+i)*4,m=i-e/2,b=-(n-t/2),f=0;var s=[[(88/255).toFixed(2),(0/255).toFixed(2),(219/255).toFixed(2)],[(219/255).toFixed(2),(47/255).toFixed(2),(7/255).toFixed(2)],[(0/255).toFixed(2),(102/255).toFixed(2),(219/255).toFixed(2)],[(219/255).toFixed(2),(212/255).toFixed(2),(0/255).toFixed(2)],[(0/255).toFixed(2),(219/255).toFixed(2),(144/255).toFixed(2)]];const d=s[Math.floor(Math.random()*s.length)],p=d[0],g=d[1],v=d[2],u=l[h+3]/255;u>0&&(c.push(m,b,f),a.push(p,g,v),r.push(u))}return{position:c,color:a,alpha:r}}function ed(n){for(var t,e=0;e<a;e++)w[e]>0&&(w[e]=.5**6);for(e=0;e<n;e++)for(t=0;t<a;t++)random=t+Math.floor(Math.random()*2)+1,w[random]>0&&(w[random]=.5**(e+7))}function en(n,t){for(let o=0;o<a;o++){var s={x:w[o],y:d[o]},e=new TWEEN.Tween(s);e.to({x:1,y:1},t+1e3);for(j=0;j<n;j++)w[o]===.5**(j+6)&&(e.delay(j*t),e.start());e.onUpdate(function(e){w[o]=e.x,d[o]=e.y})}}function es(e,t){ed(e),en(e+1,t)}function eo(){E==!1?E=!0:E=!1}function A(){v===!1?v=!0:v===!0&&(v=!1)}function q(){X=setTimeout(function(){R=Date.now()-I+N,q()},10),r=R/1e3}function Z(e){p.x=e.clientX-width/2,p.y=-(e.clientY-height/2)+header_height+camera.position.y,C.x=e.clientX/width*2-1,C.y=-(e.clientY/height)*2+1,typeof window.ontouchstart!="undefined"&&(p.x=e.changedTouches[0].pageX-width/2,p.y=-(e.changedTouches[0].pageY-height/2)+header_height+camera.position.y,C.x=e.changedTouches[0].pageX/width*2-1,C.y=-(e.changedTouches[0].pageY/height)*2+1),H.setFromCamera(C,camera);var t=H.intersectObjects(B);t.length>0&&(e.preventDefault(),L=!0),I=Date.now(),q()}function U(g){if(L===!0&&g.preventDefault(),O.x=g.clientX-width/2,O.y=-(g.clientY-height/2)+header_height+camera.position.y,typeof window.ontouchstart!="undefined"&&(O.x=g.changedTouches[0].pageX-width/2,O.y=-(g.changedTouches[0].pageY-height/2)+header_height+camera.position.y),c.x=O.x-p.x,c.y=O.y-p.y,f.x=Math.abs(c.x),f.y=Math.abs(c.y),E==!0)for(let g=0;g<a;g++){u.x=s.getX(g)*(500/camera.position.z)-8,u.y=s.getY(g)*(500/camera.position.z)+8;var t,h,b,y={x:s.getX(g),y:s.getY(g),z:d[g]},j=Math.sqrt(Math.pow(u.x-p.x,2)+Math.pow(u.y-p.y,2));if(typeof window.ontouchstart!="undefined"?(b=3):(b=2),d[g]===1&&j<5/(r*6)*b&r>.01){if(d[g]=0,c.x>0&f.y<20)l.x=1,l.y=0,m=n(50,40);else if(c.x<0&f.y<20)l.x=-1,l.y=0,m=n(50,40);else if(c.y>0&f.y>=20)l.x=0,l.y=1,m=n(50,40);else if(c.y<0&f.y>=20)l.x=0,l.y=-1,m=n(50,40);else if(f.x<5|f.y<5)return;S.x=m*l.x,S.y=m*l.y,i.x=o[3*g]+S.x+c.x/(r*20),i.y=o[3*g+1]+S.y+c.y/(r*20),t=new TWEEN.Tween(y),t.to({x:i.x,y:i.y,z:0},r*3e4),t.easing(TWEEN.Easing.Quadratic.Out),t.onUpdate(function(e){o[3*g]=e.x,o[3*g+1]=e.y,d[g]=e.z}),t.repeat(1),t.yoyo(!0),h=new TWEEN.Tween(D),h.to({x1:i.x/(r*1e3),y1:i.y*-1/(r*1e3),z1:e.position.z+2e3/(r*300),x2:i.y/1e3*-1,y2:i.x/1e3*-1},r*1e5),h.delay(2e3),h.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),h.repeat(1),h.yoyo(!0),t.start(),nav_block.style.opacity=0,nav_block.style.visibility="hidden",P=!0,v===!0&&(h.start(),A(),window.setTimeout(A,r*1e5*2+4e3))}}clearTimeout(X),N+=Date.now()-I,R=0,N=0,L=!1}function ee(){var t=e0.getDelta();requestAnimationFrame(ee),renderer.render(scene,camera),window.setTimeout(()=>{e.material.uniforms.u_time.value+=2*t},y*_-500),TWEEN.update(),e.geometry.attributes.alpha.needsUpdate=!0,e.geometry.attributes.position.needsUpdate=!0,e.geometry.attributes.color.needsUpdate=!0,e.geometry.attributes.flag.needsUpdate=!0,e.geometry.attributes.colorChangeFlag.needsUpdate=!0}function K(){const n=window.innerWidth,t=window.innerHeight,s=document.getElementById("header_nav").clientHeight;canvas.style.marginTop=s+"px";const o=700,i=864,a=1440;camera.aspect=n/(t-s),camera.updateProjectionMatrix(),typeof window.ontouchstart=="undefined"?n>=o?(camera.position.z=400,t<=i?e.material.uniforms.u_value.value=(n+t)/800-(1200+t)/n:e.material.uniforms.u_value.value=(n+t)/500-(1200+t)/n):(camera.position.z=t/n*400,e.material.uniforms.u_value.value=(n+t)/1800-(1200+t)/n):n>=a?n<t?(camera.position.z=t/n*500,e.material.uniforms.u_value.value=(n+t)/500-(1200+t)/n):camera.aspect>1.85?(camera.position.z=n/t*250,e.material.uniforms.u_value.value=(n+t)/800-(2800+t)/n):(camera.position.z=n/t*350,e.material.uniforms.u_value.value=(n+t)/500-(2800+t)/n):n<t?(camera.position.z=t/n*400,e.material.uniforms.u_value.value=(n+t)/500-(1600+t)/n,nav_block.style.bottom=t*.15+"px"):camera.aspect>1.8?(camera.position.z=n/t*250,e.material.uniforms.u_value.value=(n+t)/800-(3400+t)/n,nav_block.style.display="none"):(camera.position.z=n/t*350,e.material.uniforms.u_value.value=(n+t)/800-(2800+t)/n,nav_block.style.bottom=t*.15+"px"),renderer.setSize(n,t-s)}function eu(){if(z===!0)return;m=n(200,50);var t,r,c,l,u,h,f,p,b,j,y,_,O=[[Math.random(),Math.random()],[-1*Math.random(),Math.random()],[Math.random(),-1*Math.random()],[-1*Math.random(),-1*Math.random()]],w=O[Math.floor(Math.random()*O.length)],S=m*w[0],C=m*w[1];if(k.x=n(375,0),M.x=-1*n(400,0),k.y=n(410,0),M.y=-1*n(230,0),g.x=[k.x,M.x],g.y=[k.y,M.y],F.x=g.x[Math.floor(Math.random()*g.x.length)],F.y=g.y[Math.floor(Math.random()*g.y.length)],T.x=n(200,5)*x(),T.y=n(200,5)*x(),typeof window.ontouchstart!="undefined"?(h=30):(h=20),E==!0)for(let m=0;m<a;m++)_=s.getX(m)*(500/camera.position.z)-8,y=s.getY(m)*(500/camera.position.z)+8,j={x:s.getX(m),y:s.getY(m),z:d[m]},b=Math.sqrt(Math.pow(_-F.x,2)+Math.pow(y-F.y,2)),p=[[1,0],[-1,0],[0,1],[0,-1]],f=p[Math.floor(Math.random()*p.length)],V.x=f[0],V.y=f[1],t=n(110,80)*.001,d[m]===1&&b<h&&(d[m]=0,u=n(300,280)*n(1500,1e3),i.x=o[3*m]+S+T.x/(t*u),i.y=o[3*m+1]+C+T.y/(t*u),r=new TWEEN.Tween(j),r.to({x:i.x,y:i.y,z:0},t*u),r.easing(TWEEN.Easing.Quadratic.Out),r.onUpdate(function(e){o[3*m]=e.x,o[3*m+1]=e.y,d[m]=e.z}),r.repeat(1),r.yoyo(!0),c=new TWEEN.Tween(D),c.to({x1:i.x/(t*1e3),y1:i.y*-1/(t*1e3),z1:e.position.z+2e3/(t*500),x2:i.y/1e3*-1,y2:i.x/1e3*-1},1e4),c.delay(2e3),c.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),l=new TWEEN.Tween(D),l.to({x1:e.position.x,y1:e.position.y,z1:e.position.z,x2:e.rotation.x,y2:e.rotation.y},1e4),l.delay(2e3),l.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),c.chain(l),r.start(),P=!0,v===!0&e.position.z+2e3/(t*500)<=camera.position.z*.3&&(c.start(),A(),window.setTimeout(A,12e3*2)))}function n(t,e){return Math.floor(Math.random()*t+1-e)+e}function x(){var e=[1,-1];return e[Math.floor(Math.random()*e.length)]}function e8(){gsap.set(e.material.uniforms.u_ratio,{value:1e4}),window.setTimeout(()=>{gsap.to(e.material.uniforms.u_ratio,{value:0,duration:5,ease:"power4.out"})},0)}function e2(){for(let i=0;i<a;i++){o[3*i]=n(600,0)*x(),o[3*i+1]=n(600,0)*x(),u.x=s.getX(i)*(500/camera.position.z)-8,u.y=s.getY(i)*(500/camera.position.z)+8;var t={x:s.getX(i),y:s.getY(i)},e=new TWEEN.Tween(t);e.to({x:h.position[3*i],y:h.position[3*i+1]},3e3),e.easing(TWEEN.Easing.Quadratic.Out),e.onUpdate(function(e){o[3*i]=e.x,o[3*i+1]=e.y}),e.start()}}function em(){for(let i=0;i<a;i++){o[3*i]=n(600,0)*x(),o[3*i+1]=n(600,0)*x(),o[3*i+2]=1e3,u.x=s.getX(i)*(500/camera.position.z)-8,u.y=s.getY(i)*(500/camera.position.z)+8,u.z=s.getZ(i)*(500/camera.position.z);var t={x:s.getX(i),y:s.getY(i),z:s.getZ(i)},e=new TWEEN.Tween(t);e.to({x:h.position[3*i],y:h.position[3*i+1],z:h.position[3*i+2]},3e3),e.easing(TWEEN.Easing.Quadratic.Out),e.onUpdate(function(e){o[3*i]=e.x,o[3*i+1]=e.y,o[3*i+2]=e.z}),e.start()}}function e3(){const t=document.getElementById("nav_block"),e=document.getElementById("circle"),n=gsap.timeline();n.to(e,{duration:.5,opacity:.7,y:5}).to(e,{duration:.5,x:anime_nav.clientWidth*.5}).to(e,{duration:.8,opacity:0,x:anime_nav.clientWidth*.8,y:-5}),n.repeat(-1),window.setTimeout(()=>{P===!1&&(t.style.opacity=1,t.style.visibility="visible")},y*_+5e3)}function el(){for(let s=0;s<a;s++)if(t[3*s].toFixed(2)===(88/255).toFixed(2)|t[3*s+1].toFixed(2)===(0/255).toFixed(2)|t[3*s+2].toFixed(2)===(219/255).toFixed(2)){var n={r:t[3*s],g:t[3*s+1],b:t[3*s+2],f:b[s]},e=new TWEEN.Tween(n);e.to({r:(219/255).toFixed(2),g:(212/255).toFixed(2),b:(0/255).toFixed(2),f:1},5e3),e.onUpdate(function(e){t[3*s]=e.r,t[3*s+1]=e.g,t[3*s+2]=e.b,b[s]=e.f}),e.start()}}function Q(){window.setTimeout(()=>{for(let s=0;s<a;s++)if(b[s]===1&(t[3*s].toFixed(2)===(219/255).toFixed(2)|t[3*s+1].toFixed(2)===(212/255).toFixed(2)|t[3*s+2].toFixed(2)===(0/255).toFixed(2))){var n={r:t[3*s],g:t[3*s+1],b:t[3*s+2]},e=new TWEEN.Tween(n);e.to({r:(88/255).toFixed(2),g:(0/255).toFixed(2),b:(219/255).toFixed(2)},5e3),e.onUpdate(function(e){t[3*s]=e.r,t[3*s+1]=e.g,t[3*s+2]=e.b}),e.start()}},0),window.setTimeout(()=>{for(let s=0;s<a;s++)if(b[s]===1&(t[3*s].toFixed(2)===(88/255).toFixed(2)|t[3*s+1].toFixed(2)===(0/255).toFixed(2)|t[3*s+2].toFixed(2)===(219/255).toFixed(2))){var n={r:t[3*s],g:t[3*s+1],b:t[3*s+2],f:b[s]},e=new TWEEN.Tween(n);e.to({r:(0/255).toFixed(2),g:(102/255).toFixed(2),b:(219/255).toFixed(2)},5e3),e.onUpdate(function(e){t[3*s]=e.r,t[3*s+1]=e.g,t[3*s+2]=e.b}),e.start()}},15e3),window.setTimeout(()=>{for(let s=0;s<a;s++)if(b[s]===1&(t[3*s].toFixed(2)===(0/255).toFixed(2)|t[3*s+1].toFixed(2)===(102/255).toFixed(2)|t[3*s+2].toFixed(2)===(219/255).toFixed(2))){var n={r:t[3*s],g:t[3*s+1],b:t[3*s+2],f:b[s]},e=new TWEEN.Tween(n);e.to({r:(219/255).toFixed(2),g:(212/255).toFixed(2),b:(0/255).toFixed(2)},5e3),e.onUpdate(function(e){t[3*s]=e.r,t[3*s+1]=e.g,t[3*s+2]=e.b}),e.start()}},25e3)}})