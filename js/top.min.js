var scene=new THREE.Scene,camera,renderer;const width=window.innerWidth,height=window.innerHeight;camera=new THREE.PerspectiveCamera(75,width/height,.1,1500),camera.position.x=0,camera.position.y=30,renderer=new THREE.WebGLRenderer;const header_height=document.getElementById("header_nav").clientHeight;renderer.setSize(width,height-header_height);const wrapper=document.querySelector("#webgl");wrapper.appendChild(renderer.domElement);const geometry=new THREE.BufferGeometry,img=new Image;img.src="../img/logo.png",img.crossOrigin="anonymous",window.slide_flag=!1,window.fadein_times=4,window.interval_time=500,img.addEventListener("load",()=>{var e,n,i,a,c,l,d,u,m,f,g,v,b,y,w,C,k,A,S,M,F,T,z,D,N,R,P,I,B,V,$,X,p=en(img,img.width,img.height,2);const e0=new THREE.BufferAttribute(new Float32Array(p.position),3),e4=new THREE.BufferAttribute(new Float32Array(p.color),3),e3=new THREE.BufferAttribute(new Float32Array(p.alpha),1),Q=[],r=p.position.length/3;for(let e=0;e<r;e++)Q.push((Math.random()-1)*2,(Math.random()-1)*2);const el=new THREE.BufferAttribute(new Float32Array(Q),2),G=[];for(let e=0;e<r;e++)G.push(1);const ee=new THREE.BufferAttribute(new Float32Array(G),1),q=[];for(let e=0;e<r;e++)q.push(0);const eu=new THREE.BufferAttribute(new Float32Array(q),1);geometry.setAttribute("position",e0),geometry.setAttribute("color",e4),geometry.setAttribute("alpha",e3),geometry.setAttribute("rand",el),geometry.setAttribute("flag",ee),geometry.setAttribute("colorChangeFlag",eu);const e1=new THREE.RawShaderMaterial({vertexShader:document.querySelector("#js-vertex-shader").textContent,fragmentShader:document.querySelector("#js-fragment-shader").textContent,uniforms:{u_ratio:{type:"f",value:0},u_time:{type:"f",value:0},u_value:{type:"f",value:0},pointTexture:{value:(new THREE.TextureLoader).load("../img/triangle.png")}},transparent:!0,blending:THREE.AdditiveBlending,depthTest:!1});e=new THREE.Points(geometry,e1),v=window.innerWidth,b=window.innerHeight,n=e.geometry.attributes.position;const _=e.geometry.attributes.alpha.array,o=e.geometry.attributes.color.array,s=e.geometry.attributes.position.array,h=e.geometry.attributes.flag.array,L=e.geometry.attributes.colorChangeFlag.array,O=4,x=500;P=0,R=0;const ea=new THREE.Clock;V=[],I=new THREE.Raycaster,k=new THREE.Vector2(-2,-2),f=new THREE.Vector2,w=new THREE.Vector2,c=new THREE.Vector2,g=new THREE.Vector2,N={x1:e.position.x,y1:e.position.y,z1:e.position.z,x2:e.rotation.x,y2:e.rotation.y,z2:e.rotation.z},u=new THREE.Vector2,d=new THREE.Vector2,M=new THREE.Vector2,i=new THREE.Vector2,F=new THREE.Vector2,T=new THREE.Vector2,y=new THREE.Vector2,D=new THREE.Vector2,$=new THREE.Vector2,z=new THREE.Vector2,S=!1,a=!1,A=!1,C=!1,scene.add(e),V.push(e),window.setTimeout(()=>{ei(O-1,x),window.setTimeout(function(){S=!S},O*x),window.setTimeout(function(){a=!a},O*x)},500),er(),typeof window.ontouchstart=="undefined"?(renderer.domElement.addEventListener("mousedown",U),renderer.domElement.addEventListener("mouseup",K)):(renderer.domElement.addEventListener("touchstart",U),renderer.domElement.addEventListener("touchend",K)),W(),Z(),et(),window.setTimeout(()=>{window.setInterval(e2,1e3),window.addEventListener("blur",()=>{C=!C}),window.addEventListener("focus",()=>{C=!C})},O*x+5e3+t(5,1)*1e3),window.setTimeout(()=>{ec(88,0,219,219,212,0)},O*x+5e3+t(5,1)*1e3+15e3),J(),window.setInterval(J,25500);function W(){var t=ea.getDelta();requestAnimationFrame(W),renderer.render(scene,camera),window.setTimeout(()=>{e.material.uniforms.u_time.value+=2*t},O*x-500),TWEEN.update(),e.geometry.attributes.alpha.needsUpdate=!0,e.geometry.attributes.position.needsUpdate=!0,e.geometry.attributes.color.needsUpdate=!0,e.geometry.attributes.flag.needsUpdate=!0,e.geometry.attributes.colorChangeFlag.needsUpdate=!0}function Z(){const n=window.innerWidth,t=window.innerHeight,s=document.getElementById("header_nav").clientHeight;canvas.style.marginTop=s+"px";const o=700,i=864,a=1440;camera.aspect=n/(t-s),camera.updateProjectionMatrix(),typeof window.ontouchstart=="undefined"?n>=o?(camera.position.z=400,t<=i?e.material.uniforms.u_value.value=(n+t)/1e3-(1200+t)/n:e.material.uniforms.u_value.value=(n+t)/600-(1200+t)/n):(camera.position.z=t/n*400,e.material.uniforms.u_value.value=(n+t)/1800-(1200+t)/n):n>=a?n<t?(camera.position.z=t/n*500,e.material.uniforms.u_value.value=(n+t)/500-(1200+t)/n):camera.aspect>1.85?(camera.position.z=n/t*250,e.material.uniforms.u_value.value=(n+t)/800-(2800+t)/n):(camera.position.z=n/t*350,e.material.uniforms.u_value.value=(n+t)/500-(2800+t)/n):n<t?(camera.position.z=t/n*400,e.material.uniforms.u_value.value=(n+t)/500-(1600+t)/n,nav_block.style.bottom=t*.15+"px"):camera.aspect>1.8?(camera.position.z=n/t*250,e.material.uniforms.u_value.value=(n+t)/800-(3400+t)/n,nav_block.style.display="none"):(camera.position.z=n/t*350,e.material.uniforms.u_value.value=(n+t)/800-(2800+t)/n,nav_block.style.bottom=t*.15+"px"),renderer.setSize(n,t-s),v=window.innerWidth,b=window.innerHeight}function et(){var e=window.innerWidth,t=window.innerHeight;window.addEventListener("resize",function(){if(e==window.innerWidth&typeof window.ontouchstart!="undefined"){t<window.innerHeight?nav_block.style.bottom=height*.15+80+"px":nav_block.style.bottom=height*.15+"px";return}e=window.innerWidth,Z()})}function en(h,u,d,o){const n=document.createElement("canvas"),i=n.getContext("2d"),e=u,t=d;n.width=e,n.height=t,i.drawImage(h,0,0);const l=i.getImageData(0,0,e,t).data,c=[],a=[],r=[];for(let n=0;n<t;n+=o)for(let i=0;i<e;i+=o){const h=(n*e+i)*4,m=i-e/2,b=-(n-t/2),f=0;var s=[[(88/255).toFixed(2),(0/255).toFixed(2),(219/255).toFixed(2)],[(219/255).toFixed(2),(47/255).toFixed(2),(7/255).toFixed(2)],[(0/255).toFixed(2),(102/255).toFixed(2),(219/255).toFixed(2)],[(219/255).toFixed(2),(212/255).toFixed(2),(0/255).toFixed(2)],[(0/255).toFixed(2),(219/255).toFixed(2),(144/255).toFixed(2)]];const d=s[Math.floor(Math.random()*s.length)],p=d[0],g=d[1],v=d[2],u=l[h+3]/255;u>0&&(c.push(m,b,f),a.push(p,g,v),r.push(u))}return{position:c,color:a,alpha:r}}function es(n){for(var t,e=0;e<r;e++)_[e]>0&&(_[e]=.5**6);for(e=0;e<n;e++)for(t=0;t<r;t++)random=t+Math.floor(Math.random()*2)+1,_[random]>0&&(_[random]=.5**(e+7))}function eo(n,t){for(let o=0;o<r;o++){var s={x:_[o],y:h[o]},e=new TWEEN.Tween(s);e.to({x:1,y:1},t+1e3);for(j=0;j<n;j++)_[o]===.5**(j+6)&&(e.delay(j*t),e.start());e.onUpdate(function(e){_[o]=e.x,h[o]=e.y})}}function ei(e,t){es(e),eo(e+1,t)}function em(){gsap.set(e.material.uniforms.u_ratio,{value:1e4}),window.setTimeout(()=>{gsap.to(e.material.uniforms.u_ratio,{value:0,duration:5,ease:"power4.out"})},0)}function er(){for(let i=0;i<r;i++){s[3*i]=t(600,0)*E(),s[3*i+1]=t(600,0)*E(),u.x=n.getX(i)*(500/camera.position.z)-8,u.y=n.getY(i)*(500/camera.position.z)+8;var o={x:n.getX(i),y:n.getY(i)},e=new TWEEN.Tween(o);e.to({x:p.position[3*i],y:p.position[3*i+1]},3e3),e.easing(TWEEN.Easing.Quadratic.Out),e.onUpdate(function(e){s[3*i]=e.x,s[3*i+1]=e.y}),e.start()}}function eh(){for(let i=0;i<r;i++){s[3*i]=t(600,0)*E(),s[3*i+1]=t(600,0)*E(),s[3*i+2]=1e3,u.x=n.getX(i)*(500/camera.position.z)-8,u.y=n.getY(i)*(500/camera.position.z)+8,u.z=n.getZ(i)*(500/camera.position.z);var o={x:n.getX(i),y:n.getY(i),z:n.getZ(i)},e=new TWEEN.Tween(o);e.to({x:p.position[3*i],y:p.position[3*i+1],z:p.position[3*i+2]},3e3),e.easing(TWEEN.Easing.Quadratic.Out),e.onUpdate(function(e){s[3*i]=e.x,s[3*i+1]=e.y,s[3*i+2]=e.z}),e.start()}}function Y(){X=setTimeout(function(){P=Date.now()-B+R,Y()},10),l=P/1e3}function ed(){clearTimeout(X),R+=Date.now()-B,P=0,R=0}function U(e){f.x=e.clientX-v/2,f.y=-(e.clientY-b/2)+header_height+camera.position.y,k.x=e.clientX/v*2-1,k.y=-(e.clientY/b)*2+1,typeof window.ontouchstart!="undefined"&&(f.x=e.changedTouches[0].pageX-v/2,f.y=-(e.changedTouches[0].pageY-b/2)+header_height+camera.position.y,k.x=e.changedTouches[0].pageX/v*2-1,k.y=-(e.changedTouches[0].pageY/b)*2+1),I.setFromCamera(k,camera);var t=I.intersectObjects(V);t.length>0&&(e.preventDefault(),A=!A),B=Date.now(),Y()}function K(j){if(A&&j.preventDefault(),w.x=j.clientX-v/2,w.y=-(j.clientY-b/2)+header_height+camera.position.y,typeof window.ontouchstart!="undefined"&&(w.x=j.changedTouches[0].pageX-v/2,w.y=-(j.changedTouches[0].pageY-b/2)+header_height+camera.position.y),c.x=w.x-f.x,c.y=w.y-f.y,g.x=Math.abs(c.x),g.y=Math.abs(c.y),S)for(let v=0;v<r;v++){u.x=n.getX(v)*(500/camera.position.z)-8,u.y=n.getY(v)*(500/camera.position.z)+8;var o,p,y,O={x:n.getX(v),y:n.getY(v),z:h[v]},_=Math.sqrt(Math.pow(u.x-f.x,2)+Math.pow(u.y-f.y,2));if(typeof window.ontouchstart!="undefined"?(y=3):(y=2),h[v]===1&&_<5/(l*6)*y&l>.01){if(h[v]=0,c.x>0&g.y<20)d.x=1,d.y=0,m=t(50,40);else if(c.x<0&g.y<20)d.x=-1,d.y=0,m=t(50,40);else if(c.y>0&g.y>=20)d.x=0,d.y=1,m=t(50,40);else if(c.y<0&g.y>=20)d.x=0,d.y=-1,m=t(50,40);else if(g.x<5|g.y<5)return;M.x=m*d.x,M.y=m*d.y,i.x=s[3*v]+M.x+c.x/(l*20),i.y=s[3*v+1]+M.y+c.y/(l*20),o=new TWEEN.Tween(O),o.to({x:i.x,y:i.y,z:0},l*3e4),o.easing(TWEEN.Easing.Quadratic.Out),o.onUpdate(function(e){s[3*v]=e.x,s[3*v+1]=e.y,h[v]=e.z}),o.repeat(1),o.yoyo(!0),p=new TWEEN.Tween(N),p.to({x1:i.x/(l*1e3),y1:i.y*-1/(l*1e3),z1:e.position.z+2e3/(l*300),x2:i.y/1e3*-1,y2:i.x/1e3*-1},l*1e5),p.delay(2e3),p.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),p.repeat(1),p.yoyo(!0),o.start(),nav_block.style.opacity=0,nav_block.style.visibility="hidden",slide_flag=!slide_flag,a&&(p.start(),a=!a,window.setTimeout(function(){a=!a},l*1e5*2+4e3))}}ed(),A=!A}function t(t,e){return Math.floor(Math.random()*t+1-e)+e}function E(){var e=[1,-1];return e[Math.floor(Math.random()*e.length)]}function e2(){if(C)return;if(F.x=t(375,0),T.x=-1*t(400,0),F.y=t(410,0),T.y=-1*t(230,0),y.x=[F.x,T.x],y.y=[F.y,T.y],D.x=y.x[Math.floor(Math.random()*y.x.length)],D.y=y.y[Math.floor(Math.random()*y.y.length)],z.x=t(200,5)*E(),z.y=t(200,5)*E(),typeof window.ontouchstart!="undefined")var o,c,l,d,u,f,p,g,v,b,j,_,w,O,x,k=30;else k=20;if(m=t(200,50),f=[[Math.random(),Math.random()],[-1*Math.random(),Math.random()],[Math.random(),-1*Math.random()],[-1*Math.random(),-1*Math.random()]],v=f[Math.floor(Math.random()*f.length)],x=m*v[0],O=m*v[1],S)for(let m=0;m<r;m++)w=n.getX(m)*(500/camera.position.z)-8,_=n.getY(m)*(500/camera.position.z)+8,j={x:n.getX(m),y:n.getY(m),z:h[m]},b=Math.sqrt(Math.pow(w-D.x,2)+Math.pow(_-D.y,2)),p=[[1,0],[-1,0],[0,1],[0,-1]],g=p[Math.floor(Math.random()*p.length)],$.x=g[0],$.y=g[1],o=t(110,80)*.001,h[m]===1&&b<k&&(h[m]=0,u=t(300,280)*t(1500,1e3),i.x=s[3*m]+x+z.x/(o*u),i.y=s[3*m+1]+O+z.y/(o*u),c=new TWEEN.Tween(j),c.to({x:i.x,y:i.y,z:0},o*u),c.easing(TWEEN.Easing.Quadratic.Out),c.onUpdate(function(e){s[3*m]=e.x,s[3*m+1]=e.y,h[m]=e.z}),c.repeat(1),c.yoyo(!0),l=new TWEEN.Tween(N),l.to({x1:i.x/(o*1e3),y1:i.y*-1/(o*1e3),z1:e.position.z+2e3/(o*500),x2:i.y/1e3*-1,y2:i.x/1e3*-1},1e4),l.delay(2e3),l.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),d=new TWEEN.Tween(N),d.to({x1:e.position.x,y1:e.position.y,z1:e.position.z,x2:e.rotation.x,y2:e.rotation.y},1e4),d.delay(2e3),d.onUpdate(function(t){e.position.x=t.x1,e.position.y=t.y1,e.position.z=t.z1,e.rotation.x=t.x2,e.rotation.y=t.y2}),l.chain(d),c.start(),slide_flag=!slide_flag,a&e.position.z+2e3/(o*500)<=camera.position.z*.3&&(l.start(),a=!a,window.setTimeout(function(){a=!a},12e3*2)))}function ec(t,l,n,s,i,a){for(let d=0;d<r;d++)if(o[3*d].toFixed(2)===(t/255).toFixed(2)|o[3*d+1].toFixed(2)===(l/255).toFixed(2)|o[3*d+2].toFixed(2)===(n/255).toFixed(2)){var c={r:o[3*d],g:o[3*d+1],b:o[3*d+2],f:L[d]},e=new TWEEN.Tween(c);e.to({r:(s/255).toFixed(2),g:(i/255).toFixed(2),b:(a/255).toFixed(2),f:1},5e3),e.onUpdate(function(e){o[3*d]=e.r,o[3*d+1]=e.g,o[3*d+2]=e.b,L[d]=e.f}),e.start()}}function H(t,l,n,s,i,a){for(let d=0;d<r;d++)if(L[d]===1&(o[3*d].toFixed(2)===(t/255).toFixed(2)|o[3*d+1].toFixed(2)===(l/255).toFixed(2)|o[3*d+2].toFixed(2)===(n/255).toFixed(2))){var c={r:o[3*d],g:o[3*d+1],b:o[3*d+2],f:L[d]},e=new TWEEN.Tween(c);e.to({r:(s/255).toFixed(2),g:(i/255).toFixed(2),b:(a/255).toFixed(2)},5e3),e.onUpdate(function(e){o[3*d]=e.r,o[3*d+1]=e.g,o[3*d+2]=e.b}),e.start()}}function J(){window.setTimeout(()=>{H(219,212,0,88,0,219)},15e3),window.setTimeout(()=>{H(88,0,219,0,102,219)},3e4),window.setTimeout(()=>{H(0,102,219,219,212,0)},45e3)}})